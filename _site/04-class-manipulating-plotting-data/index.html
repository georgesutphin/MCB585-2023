















<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2021-09-28 22:41:34 -0700">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/syntax.css" />

    



    <!-- Favicons for everyone -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../assets/favicons/mcb585/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/favicons/mcb585/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/favicons/mcb585/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/favicons/mcb585/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../assets/favicons/mcb585/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../assets/favicons/mcb585/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../assets/favicons/mcb585/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../assets/favicons/mcb585/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content=" - MCB 585: Multidisciplinary/Quantitative Approaches to Solving Biological Problems"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="../assets/favicons/mcb585/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="../assets/favicons/mcb585/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="../assets/favicons/mcb585/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="../assets/favicons/mcb585/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="../assets/favicons/mcb585/mstile-310x310.png" />


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
    <title>MCB 585: Multidisciplinary/Quantitative Approaches to Solving Biological Problems: Manipulating and Plotting Data</title>
  </head>
  <body>

    



    <div class="container">
      






<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      
      <a href="https://georgesutphin.github.io/MCB585/" class="pull-left">
        <img class="navbar-logo" src="../assets/img/mcb585-logo.svg" alt="MCB585 logo" />
      </a>
      

      
      <a class="navbar-brand" href="../">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>

        
	
        <li><a href="../setup.html">Setup</a></li>

        
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../01-class-introduction/index.html">Getting started with R and RStudio</a></li>
            
            <li><a href="../01-oyo-introduction/index.html">Getting started with R and RStudio -- Additional Detail</a></li>
            
            <li><a href="../02-class-R-data-types-structures/index.html">Basic Data Types and Data Structures in R</a></li>
            
            <li><a href="../02-oyo-R-data-types-in-depth/index.html">R Data Types -- In-Depth</a></li>
            
            <li><a href="../03-class-data-frames/index.html">Data Frames, Basic Indexing, Reading/Writing Data</a></li>
            
            <li><a href="../03-oyo-Lists/index.html">Lists and Advanced Indexing</a></li>
            
            <li><a href="../04-class-manipulating-plotting-data/index.html">Manipulating and Plotting Data</a></li>
            
            <li><a href="../04-oyo-advanced-data-manipulation/index.html">Advanced Data Manipulation and Plotting</a></li>
            
            <li><a href="../05-class-decisions-loops/index.html">Decision Making and Loops</a></li>
            
            <li><a href="../05-oyo-more-decisions-loops/index.html">Decision Making and Loops -- Additional Detail</a></li>
            
            <li><a href="../06-class-distributions/index.html">Distributions and Normality</a></li>
            
            <li><a href="../06-oyo-more-distributions/index.html">Distributions and Normality -- Additional Detail</a></li>
            
            <li><a href="../07-class-hypothesis-testing/index.html">Hypothesis Testing</a></li>
            
            <li><a href="../07-oyo-multiple-test-correction/index.html">Multiple Test Correction</a></li>
            
            <li><a href="../08-class-survival-analysis/index.html">Survival Analysis</a></li>
            
            <li><a href="../08-oyo-advanced-survival-analysis/index.html">Advanced Survival Analysis</a></li>
            
            <li><a href="../09-class-power-analysis/index.html">Power Analysis</a></li>
            
            <li><a href="../09-oyo-simulation/index.html">Simulating Experiments</a></li>
            
            <li><a href="../99-projects/index.html">Final Projects</a></li>
            
	    <li role="separator" class="divider"></li>
            <li><a href="../aio.html">All in one page (Beta)</a></li>
          </ul>
        </li>
	

	
	<!--
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../reference.html">Reference</a></li>
            
            <li><a href="../about/">About</a></li>
            
            <li><a href="../discuss/">Discussion</a></li>
            
            <li><a href="../figures/">Figures</a></li>
            
            <li><a href="../guide/">Instructor Notes</a></li>
            
          </ul>
        </li>
	-->

	
        <li><a href="../LICENSE.html">About</a></li>
	<!--
	
	<li><a href="/edit//_episodes_rmd/04-class-manipulating-plotting-data.Rmd">Improve this page <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
	
	-->
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>

















<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../03-oyo-Lists/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
    <h3 class="maintitle"><a href="../">MCB 585: Multidisciplinary/Quantitative Approaches to Solving Biological Problems</a></h3>
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../04-oyo-advanced-data-manipulation/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>

<article>
<div class="row">
  <div class="col-md-1">
  </div>
  <div class="col-md-10">
    <h1 class="maintitle">Manipulating and Plotting Data</h1>
  </div>
  <div class="col-md-1">
  </div>
</div>


<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Class Date:</strong> 9/2/2021 -- In Class
      <br/>
      <strong>Teaching:</strong> 90 min
      <br/>
      <strong>Exercises:</strong> 30 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>How do I read data from a .csv or .txt file into R?</p>
</li>
	
	<li><p>How do I write data to a .csv or .txt file?</p>
</li>
	
	<li><p>How do I calculate simple statistics from my data?</p>
</li>
	
	<li><p>How can I plot my data?</p>
</li>
	
	<li><p>How do I save my plots to a PDF file?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Be able to employ functions available in the base R language to calculate basis statistics for a dataset.</p>
</li>
	
	<li><p>Generate and display simple graphs.</p>
</li>
	
	<li><p>Save plot(s) to a PDF file.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h2 id="in-class">In Class</h2>

<h3 id="calculating-basic-statistics">Calculating basic statistics</h3>

<p>The standard R installation provides many functions for calculating basic statistics about your data. Here is a sampling of some of the most generally useful:</p>

<blockquote class="callout">
  <h2 id="functions-for-calculating-descriptive-statistics">Functions for calculating descriptive statistics</h2>

  <p>Averages:</p>
  <ul>
    <li><code class="language-plaintext highlighter-rouge">mean()</code> - arithmetic mean</li>
    <li><code class="language-plaintext highlighter-rouge">median()</code> - median</li>
    <li><code class="language-plaintext highlighter-rouge">mode()</code> - mode</li>
  </ul>

  <p>Range:</p>
  <ul>
    <li><code class="language-plaintext highlighter-rouge">min()</code> - minimum value in range</li>
    <li><code class="language-plaintext highlighter-rouge">max()</code> - maximum value in range</li>
    <li><code class="language-plaintext highlighter-rouge">range()</code> - minimum and maximum value in range</li>
    <li><code class="language-plaintext highlighter-rouge">quantile()</code> - quantiles corresponding to the given probabilities (<code class="language-plaintext highlighter-rouge">probs</code> argument; defaults to quartiles `c(0, 0.25, 0.5, 0.75, 1.0))</li>
    <li><code class="language-plaintext highlighter-rouge">IQR()</code> - interquartile range (Q3 - Q1)</li>
  </ul>

  <p>Variability:</p>
  <ul>
    <li><code class="language-plaintext highlighter-rouge">var()</code> - variance</li>
    <li><code class="language-plaintext highlighter-rouge">sd()</code> - standard deviation</li>
    <li><code class="language-plaintext highlighter-rouge">mad()</code> - median absolute deviation
<em>Note: there is no built-in function for calculating standard error of mean (SEM), but this can be easily calculated using <code class="language-plaintext highlighter-rouge">sd(x)/sqrt(length(x))</code>. There are also packages that have functions available (e.g. <code class="language-plaintext highlighter-rouge">pastecs</code>).</em></li>
  </ul>

  <p>Miscellaneous:</p>
  <ul>
    <li><code class="language-plaintext highlighter-rouge">summary()</code> - summary statistics based on data type</li>
    <li><code class="language-plaintext highlighter-rouge">table()</code> - generate frequency or contingency table</li>
  </ul>
</blockquote>

<p> </p>

<p>Let’s start by performing some common mathematical operations to learn more about our data.We will load a fresh copy of our sample data to reset any unintended changes from previous lessons and be sure that we include <code class="language-plaintext highlighter-rouge">header=TRUE</code> and <code class="language-plaintext highlighter-rouge">stringsAsFactors=FALSE</code> arguments.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s2">"data/sample.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">stringsAsFactors</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>This data is the result of a fictional experiment looking at the number of aneurisms that formed in the eyes of patients who undertook 3 different treatments.</p>

<p>We can use the basic descriptive functions to calculate values like minimum, mean, median, and standard deviation of a given variable data:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># minimum number of aneurisms in q3</span><span class="w">
</span><span class="nf">min</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Aneurisms_q3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 105
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># mean number of aneurisms in q3</span><span class="w">
</span><span class="n">mean</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Aneurisms_q3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 219.85
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># median number of aneurisms in q3</span><span class="w">
</span><span class="n">median</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Aneurisms_q3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 217
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># standard deviation number of aneurisms in q3</span><span class="w">
</span><span class="n">sd</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Aneurisms_q3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 48.76958
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># total number of observations in q3</span><span class="w">
</span><span class="nf">length</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Aneurisms_q3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 100
</code></pre></div></div>

<p> </p>

<p>R has a function called <code class="language-plaintext highlighter-rouge">summary()</code> that provides a convenient summary of each column if all you want is some basic statistics about each of your variables (without reference to subsets):</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Summarize function</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      ID               Gender             Group           BloodPressure  
 Length:100         Length:100         Length:100         Min.   : 62.0  
 Class :character   Class :character   Class :character   1st Qu.:107.5  
 Mode  :character   Mode  :character   Mode  :character   Median :117.5  
                                                          Mean   :118.6  
                                                          3rd Qu.:133.0  
                                                          Max.   :173.0  
      Age         Aneurisms_q1    Aneurisms_q2    Aneurisms_q3  
 Min.   :12.10   Min.   : 65.0   Min.   : 80.0   Min.   :105.0  
 1st Qu.:14.78   1st Qu.:118.0   1st Qu.:131.5   1st Qu.:182.5  
 Median :16.65   Median :158.0   Median :162.5   Median :217.0  
 Mean   :16.42   Mean   :158.8   Mean   :168.0   Mean   :219.8  
 3rd Qu.:18.30   3rd Qu.:188.0   3rd Qu.:196.8   3rd Qu.:248.2  
 Max.   :20.00   Max.   :260.0   Max.   :283.0   Max.   :323.0  
  Aneurisms_q4  
 Min.   :116.0  
 1st Qu.:186.8  
 Median :219.0  
 Mean   :217.9  
 3rd Qu.:244.2  
 Max.   :315.0  
</code></pre></div></div>

<p> </p>

<p>For every column in the data frame, <code class="language-plaintext highlighter-rouge">summary()</code> provides different set of information depending on the class of that column. For instance, for <code class="language-plaintext highlighter-rouge">numeric</code> columns, <code class="language-plaintext highlighter-rouge">summary()</code> provides minimum, maximum, mean, median, and quartile values.</p>

<p>When analyzing data we usually want to look at partial statistics, such as the maximum value of a phenotype for a given patient or the average value per treatment group. The most direct way to accomplish this goal is to use indexing to select the data subset we want and then perform the calculation on the data subset:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># select aneurism data for the first subject</span><span class="w">
</span><span class="n">sub1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dat</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="o">:</span><span class="m">9</span><span class="p">]</span><span class="w">

</span><span class="c1"># calculate the max number of aneurisms for subject 1 across # time points</span><span class="w">
</span><span class="nf">max</span><span class="p">(</span><span class="n">sub1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 237
</code></pre></div></div>

<p> </p>

<p>We don’t actually need to store the row in a variable of its own. Instead, we can combine the selection and the function call:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># maximum number of aneurisms for subject 2</span><span class="w">
</span><span class="nf">max</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="o">:</span><span class="m">9</span><span class="p">])</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 248
</code></pre></div></div>

<p> </p>

<p>The <code class="language-plaintext highlighter-rouge">table()</code> function calculates frequency or contingency tables, which can be useful for understanding the structure of our data. For example, we can look at the number of patients in each treatment group:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">table</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Group</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
   Control Treatment1 Treatment2 
        30         35         35 
</code></pre></div></div>

<p> </p>

<p>By including multiple arguments from the dataset, we can look at the data broken down across multiple variables, such as treatment group and gender:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">table</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Group</span><span class="p">,</span><span class="w"> </span><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            
              f  F  m  M
  Control    13  1 14  2
  Treatment1 10  2 15  8
  Treatment2 12  1 17  5
</code></pre></div></div>

<p> </p>

<p>Oops… Looks like someone was being lazy with their data entry for gender. How can we fix the capitalization error?</p>

<blockquote class="challenge">
  <h2 id="correcting-capitalization">Correcting capitalization</h2>

  <p>There is a mixture of lower case (m, f) and uppder case
entries in the <code class="language-plaintext highlighter-rouge">dat$Gender</code> variable.</p>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># First load the data if you haven't already</span><span class="w">
</span><span class="n">dat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s2">"data/sample.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> 
</span><span class="n">stringsAsFactors</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">

</span><span class="c1"># Look at the `Gender` data</span><span class="w">
</span><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="w">
</span></code></pre></div>  </div>

  <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [1] "m" "m" "m" "f" "m" "M" "f" "m" "m" "f" "m" "f" "f" "m" "m" "m" "f" "m"
 [19] "m" "F" "f" "m" "f" "f" "m" "M" "M" "f" "m" "f" "f" "m" "m" "m" "m" "f"
 [37] "f" "m" "M" "m" "f" "m" "m" "m" "f" "f" "M" "M" "m" "m" "m" "f" "f" "f"
 [55] "m" "f" "m" "m" "m" "f" "f" "f" "f" "M" "f" "m" "f" "f" "M" "m" "m" "m"
 [73] "F" "m" "m" "f" "M" "M" "M" "f" "m" "M" "M" "m" "m" "f" "f" "f" "m" "m"
 [91] "f" "m" "F" "f" "m" "m" "F" "m" "M" "M"
</code></pre></div>  </div>

  <p>Correct all <code class="language-plaintext highlighter-rouge">Gender</code> values to upper case.</p>

  <blockquote class="solution">
    <h2 id="solution">Solution</h2>

    <p>Option 1 - use data subsets and logical indexing to 
correct <code class="language-plaintext highlighter-rouge">m</code>s and <code class="language-plaintext highlighter-rouge">f</code>s individually:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="p">[</span><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"m"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"M"</span><span class="w">
</span><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="p">[</span><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"f"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"F"</span><span class="w">
</span><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [1] "M" "M" "M" "F" "M" "M" "F" "M" "M" "F" "M" "F" "F" "M" "M" "M" "F" "M"
 [19] "M" "F" "F" "M" "F" "F" "M" "M" "M" "F" "M" "F" "F" "M" "M" "M" "M" "F"
 [37] "F" "M" "M" "M" "F" "M" "M" "M" "F" "F" "M" "M" "M" "M" "M" "F" "F" "F"
 [55] "M" "F" "M" "M" "M" "F" "F" "F" "F" "M" "F" "M" "F" "F" "M" "M" "M" "M"
 [73] "F" "M" "M" "F" "M" "M" "M" "F" "M" "M" "M" "M" "M" "F" "F" "F" "M" "M"
 [91] "F" "M" "F" "F" "M" "M" "F" "M" "M" "M"
</code></pre></div>    </div>

    <p>Option 2 - use the <code class="language-plaintext highlighter-rouge">toupper()</code> function to correct
the entire vector at once:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">toupper</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="p">)</span><span class="w">
</span><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [1] "M" "M" "M" "F" "M" "M" "F" "M" "M" "F" "M" "F" "F" "M" "M" "M" "F" "M"
 [19] "M" "F" "F" "M" "F" "F" "M" "M" "M" "F" "M" "F" "F" "M" "M" "M" "M" "F"
 [37] "F" "M" "M" "M" "F" "M" "M" "M" "F" "F" "M" "M" "M" "M" "M" "F" "F" "F"
 [55] "M" "F" "M" "M" "M" "F" "F" "F" "F" "M" "F" "M" "F" "F" "M" "M" "M" "M"
 [73] "F" "M" "M" "F" "M" "M" "M" "F" "M" "M" "M" "M" "M" "F" "F" "F" "M" "M"
 [91] "F" "M" "F" "F" "M" "M" "F" "M" "M" "M"
</code></pre></div>    </div>

    <p>For good measure, let’s save the corrected data to a new file</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">write.csv</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"data/sample-gendercorrected.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="o">=</span><span class="nb">F</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
  </blockquote>
</blockquote>

<p> </p>

<p>Now the contingency table is more useful:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">table</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Group</span><span class="p">,</span><span class="w"> </span><span class="n">dat</span><span class="o">$</span><span class="n">Gender</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            
              F  M
  Control    14 16
  Treatment1 12 23
  Treatment2 13 22
</code></pre></div></div>

<p> </p>

<p>In many instances, we will want to break data down by groups (e.g. treatment groups) and calculate statistics on each sub group. Functions like <code class="language-plaintext highlighter-rouge">apply()</code> and <code class="language-plaintext highlighter-rouge">aggregate()</code> are designed for this purpose, and you will be looking at how to use these <em>On Your Own</em>.</p>

<hr />
<h3 id="plotting">Plotting</h3>

<p>The mathematician Richard Hamming once said,</p>

<p>      <em>“The purpose of computing is insight, not numbers.”</em></p>

<p>The best way to develop insight is often to visualize data. Visualization deserves an entire lecture (or course) of its own, and we will touch on various aspects of R’s plotting functionality later on in the course, but for now we will introduce a few of R’s plotting features.</p>

<blockquote class="callout">
  <h2 id="an-alternative-package-for-plotting-in-r">An alternative package for plotting in R</h2>

  <p>There is a popular package called <code class="language-plaintext highlighter-rouge">ggplot2</code> that many R users prefer to the base plotting functions included with R. This package is more efficient in many ways and most users like the default look of the graphics better. For these reasons, <code class="language-plaintext highlighter-rouge">ggplot2</code> is worth exploring. The caveat is that <code class="language-plaintext highlighter-rouge">ggplot2</code> uses a very different syntax for generating plots and does have a few limitations. My personal preference is to use R base graphics, because I often create more complex graphics, and base package is flexible enough to do <em>anything</em> once you understand all of the ins and outs of the various plotting functions. I have run into a few places where generating the exact graphic I wanted was not possible in <code class="language-plaintext highlighter-rouge">ggplot2</code>.</p>
</blockquote>

<p> </p>

<p>The basic plot function in R is called, conveniently, <code class="language-plaintext highlighter-rouge">plot()</code>. Let’s take a quick look:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">?</span><span class="n">plot</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>In it’s most basic form, <code class="language-plaintext highlighter-rouge">plot(x,y)</code> function will create a scatter plot with points defined by the vectors <code class="language-plaintext highlighter-rouge">x</code> and <code class="language-plaintext highlighter-rouge">y</code>. Let’s start out with the iris data set and look at the relationship between petal length and width:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-04-class-manipulating-plotting-data-unnamed-chunk-15-1.png" title="plot of chunk unnamed-chunk-15" alt="plot of chunk unnamed-chunk-15" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>Congratulations! You have plotted your first data in R. So what is going on in the background here? Let’s talk about what R is actually doing when you give it the plot command.</p>

<p> </p>
<h4 id="graphics-devices">Graphics devices</h4>

<p>When you tell R to run a plot, it actually takes a series of actions:</p>

<ol>
  <li>Opens a new “graphics device”. This device can be one of several things:
 a. The <strong>Plot</strong> pane in the lower-right panel of RStudio. RStudio uses this graphics device by default if you don’t tell it to use something else.
 b. A blank graphics pane in a new window (this requires the <code class="language-plaintext highlighter-rouge">windows()</code> or <code class="language-plaintext highlighter-rouge">quartz()</code> commands, which we discuss below).
 c. An external image file (e.g. a new <em>.jpg</em> file).
 d. An external PDF file (complete with vector graphics!).</li>
  <li>Draws a series of objects; this part is done “under the hood” of the <code class="language-plaintext highlighter-rouge">plot()</code> function, and includes:
 a. Axes.
 b. Tick marks.
 c. Axis labels.
 d. Data points.
 e. Legend(s).
 f. Chart titles.
 g. Other text, if specified.</li>
  <li>Leaves the current graphics device open for additional drawing input. This step is important, because it means that you can continue to add things to the current image by calling additional functions.</li>
  <li>Closes the graphics device following a <code class="language-plaintext highlighter-rouge">dev.off()</code> function call. This essentially “finalizes” the image.</li>
</ol>

<p>Note that you can have multiple graphics devices open at once. R will, by default, write new graphics to the most recently used or created graphics device. Some functions, like <code class="language-plaintext highlighter-rouge">plot()</code> automatically start a new graphics device (or page in the case of the RStudio panel or a PDF), while other functions, like <code class="language-plaintext highlighter-rouge">lines()</code>, will add graphical elements to the most recently used device.</p>

<p>Let’s repeat our above <code class="language-plaintext highlighter-rouge">plot()</code> command in a few different graphics devices to illustrate a their functionality.</p>

<p> </p>

<p><strong>Plotting in a separate window</strong></p>

<p>I often find it useful to plot to a separate window, rather than the <strong>Plot</strong> pane, because it better simulates plotting to a file like a PDF, which is usually the final goal of building a plot. The window allows you to follow the creation of your graphic live, while you can’t see what is happening in a <em>.jpg</em> or <em>.pdf</em> until you have finalized the graphic.</p>

<p>To plot in a separate window within RStudio, use one of the following platform-dependent functions:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">windows</span><span class="p">()</span><span class="w"> </span><span class="c1"># Windows</span><span class="w">
</span><span class="n">quartz</span><span class="p">()</span><span class="w"> </span><span class="c1"># MacOS</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>Now recreate our above plot:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-04-class-manipulating-plotting-data-unnamed-chunk-17-1.png" title="plot of chunk unnamed-chunk-17" alt="plot of chunk unnamed-chunk-17" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>Note that we can now add additional elements to this plot. Let’s add a chart title:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">title</span><span class="p">(</span><span class="s2">"Relationship between petal length and petal width"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-04-class-manipulating-plotting-data-unnamed-chunk-18-1.png" title="plot of chunk unnamed-chunk-18" alt="plot of chunk unnamed-chunk-18" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>We can shutdown the window by either just closing it, or from RStudio using the <code class="language-plaintext highlighter-rouge">dev.off()</code> function.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dev.off</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>null device 
          1 
</code></pre></div></div>

<p> </p>

<p><strong>Plotting to an external file</strong></p>

<p>R has a series of functions designed to open a graphics device that will write directly to an external file. These files can be image files or PDFs.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">bmp()</code> generates a <em>.bmp</em></li>
  <li><code class="language-plaintext highlighter-rouge">jpeg()</code> generates a <em>.jpg</em></li>
  <li><code class="language-plaintext highlighter-rouge">png()</code> generates a <em>.png</em></li>
  <li><code class="language-plaintext highlighter-rouge">tiff()</code> generates a <em>.tif</em></li>
  <li><code class="language-plaintext highlighter-rouge">pdf()</code> generates a <em>.pdf</em></li>
</ul>

<p>The first four are all versions of the same function and behave essentially interchangably. PDF is a separate function. The primary difference between the two is that the non-PDF image files will have a defined resolution, while the PDF files are generated as <em>vector graphics</em>, meaning that they maintain resolution at any size.</p>

<blockquote class="callout">
  <h2 id="vector-graphics">Vector graphics</h2>

  <p>Traditional image formats (e.g. .bmp, .jpg, .tiff, .png) are, in essence, a two dimensional array of color and intensity values (such as
red-green-blue, or RGB values). The array has a fixed number of pixels in each dimension, so if you take an image that is 1 in x 1 in with
100 pixels in each dimension, and blow it up to 1 ft x ft, it still only has 100 pixels in each dimension. The blowup image will appear
blocky, or “pixelated”.</p>

  <p>Vector graphics are distinct from traditional graphics in that they are defined by a set of mathematical operations carried out at specified &gt; coordinates. For example, two of the instructions may be something like:</p>
  <ol>
    <li>Draw the letter “A” in normal size 10 Arial font at coordinates (10, 10).</li>
    <li>Draw the an arrow with line weight 2 and arrow head style X size 4 from the point (12, 12) to the point (20, 20).</li>
  </ol>

  <p>These instructions are the same for a 1 in x 1 in image and a 1 ft x 1 ft image (or a 1 mile x 1 mile image). Because the shape of the
letter and the arrow are defined by the font and the arrow head style, when the image is rendered, they can be drawn with the appropriate
number of pixels to appear crisp and smooth at the image size requested.</p>

  <p>This is how PDF files and other vector graphic formats work. They are really convenient for preparing manuscripts because journals often
want a low-res file for review and a high-res file for publication. By starting with a PDF you can generate both categories of graphic with
the same underlying file. any modern journals prefer that figures be submitted as PDF or other vector graphics format for this very reason.</p>
</blockquote>

<p> </p>

<p>Let’s give both types of graphic generation a try by generating our previous plot as a <em>.jpg** and **.PDF</em> file.</p>

<p>First, let’s create a new directory in our class folder for results (another best practice). We can do from within R using the <code class="language-plaintext highlighter-rouge">dir.create()</code> function:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dir.create</span><span class="p">(</span><span class="s2">"results"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>Take a look at the <code class="language-plaintext highlighter-rouge">jpeg()</code> function to see what it needs:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">?</span><span class="n">jpeg</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>Technically, you don’t have to give <code class="language-plaintext highlighter-rouge">jpeg()</code> any input. By default, the function will generate a new <em>.jpg</em> image with an automatically generated name in our home directory. However, we want to at least specify both a directory and a file name for the newly created image.</p>

<p>Also by default, the function will produce a 480 px x 480 px image at 72 pixels per inch (ppi). Note that the actual physical image size will be <strong>size inches = size in pixels/ppi</strong>. Let’s make a 100 ppi <em>.jpg</em> image that is 5 in x 5 in:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">jpeg</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"results/petal-width-length-comparison.jpg"</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">500</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">500</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>Now look inside your results folder. If the <code class="language-plaintext highlighter-rouge">jpeg()</code> function worked correctly and our directories were correctly specified, you should now see a new file called <em>petal-width-length-comparison.jpg</em>. What happens when you try to open this file?</p>

<p>You should get an error. This is because the file has been created, but that it is currently open in RStudio waiting for more input. We can use the <code class="language-plaintext highlighter-rouge">dev.cur()</code> to confirm that the active graphics device is indeed the JPEG file.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dev.cur</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>Let’s give it our earlier <code class="language-plaintext highlighter-rouge">plot()</code> and <code class="language-plaintext highlighter-rouge">title()</code> commands, and then turn off the device (using <code class="language-plaintext highlighter-rouge">dev.off()</code>) to complete and close the file.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">)</span><span class="w">
</span><span class="n">title</span><span class="p">(</span><span class="s2">"Relationship between petal length and petal width"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-04-class-manipulating-plotting-data-unnamed-chunk-24-1.png" title="plot of chunk unnamed-chunk-24" alt="plot of chunk unnamed-chunk-24" width="612" style="display: block; margin: auto;" /></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dev.off</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jpeg 
   3 
</code></pre></div></div>

<p> </p>

<p>Now try opening the <em>petal-width-length-comparison.jpg</em>. We have our chart in JPG format! Zoom in to check out the resolution. Not great? Generating JPEG or other graphics formats is useful for some applications (e.g. charts for use in a webpage, for example), but for generating reports and paper figures, vector graphics are the way to go. That’s why I tend to work almost exclusively generate my charts as PDF files, and so will we for the rest of the course.</p>

<p>So let’s do it. First let’s take a look at the <code class="language-plaintext highlighter-rouge">pdf()</code> function:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">?</span><span class="n">pdf</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>While <code class="language-plaintext highlighter-rouge">pdf()</code> still wants the file name as the <code class="language-plaintext highlighter-rouge">file = </code> argument, we now specify width and height in inches to define the size of the file, and exclude resolution because PDF files are vector graphics and will be generated to the resolution required by the size. This is more intuitive (we just ask for the image size that we way, instead of having to calculate it from pixel number and ppi), and more convenient. We can now generate any size output we want, including a nice, printable 8.5 in x 11 in standard paper size. This is useful for reports. Usually a smaller figure is more appropriate when generating a figure that you will embed in a manuscript.</p>

<p>For the moment, we will generate the PDF equivalent of our earlier JPEG, with dimensions of 5 in x 5 in. For fun, let’s also include a second plot that compares sepal length and width:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># generate the PDF file</span><span class="w">
</span><span class="n">pdf</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"results/iris-aspect-ratio-comparison.pdf"</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="w">

</span><span class="c1"># plot petal length vs. width</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">)</span><span class="w">
</span><span class="n">title</span><span class="p">(</span><span class="s2">"Relationship between petal length and petal width"</span><span class="p">)</span><span class="w">

</span><span class="c1"># plot petal length vs. width</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Width</span><span class="p">)</span><span class="w">
</span><span class="n">title</span><span class="p">(</span><span class="s2">"Relationship between sepal length and sepal width"</span><span class="p">)</span><span class="w">

</span><span class="c1"># finalize the PDF</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>Notice a couple of important things:</p>
<ul>
  <li>Zooming in and out in the PDF does not affect image resolution. It always looks sharp! This is the advantage of vector graphics.</li>
  <li>Running <code class="language-plaintext highlighter-rouge">plot()</code> the second time generated a second page in the PDF file. If you want a new file for every figure, set the argument <code class="language-plaintext highlighter-rouge">onefile = T</code> in the <code class="language-plaintext highlighter-rouge">pdf()</code> function (see the <code class="language-plaintext highlighter-rouge">?pdf</code> documentation for details).</li>
</ul>

<p> </p>
<h4 id="fixing-the-axis-labels">Fixing the axis labels</h4>

<p>Okay, so we know how to generate a chart. Clearly the default parameters are not what we want. First, what is up with the axis labels? By default, R will just use the variable name as the axis labels, having nothing else to work with. We can add out own labels with the <code class="language-plaintext highlighter-rouge">xlab</code> and <code class="language-plaintext highlighter-rouge">ylab</code> arguments.</p>

<p>For now, we will just use the plot window in RStudio to demonstrate a few of the features of <code class="language-plaintext highlighter-rouge">plot()</code>. To make sure you don’t have any open graphics devices, run <code class="language-plaintext highlighter-rouge">dev.off()</code> a few times before moving forward.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">,</span><span class="w">
     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Length (cm)"</span><span class="p">,</span><span class="w"> 
     </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Width (cm)"</span><span class="p">)</span><span class="w"> 
</span></code></pre></div></div>

<p><img src="../fig/rmd-04-class-manipulating-plotting-data-unnamed-chunk-27-1.png" title="plot of chunk unnamed-chunk-27" alt="plot of chunk unnamed-chunk-27" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>That’s better!</p>

<p>Now, looking at the data itself, there does seem to be an odd pattern. There is clearly a distinct group in the lower left corner with smaller petals. Let’s remind ourselves what information we have available:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa
</code></pre></div></div>

<p> </p>

<p>The most obvious candidate to explain the separate grouping is species. We can add color to see if that grouping is all one species using the <code class="language-plaintext highlighter-rouge">col</code> argument. R has many color names available by default which can be listed using the <code class="language-plaintext highlighter-rouge">colors()</code> function:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">colors</span><span class="p">())</span><span class="w"> 
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] "white"         "aliceblue"     "antiquewhite"  "antiquewhite1"
[5] "antiquewhite2" "antiquewhite3"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">length</span><span class="p">(</span><span class="n">colors</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 657
</code></pre></div></div>

<p> </p>

<p>To request a specific color, simply specify the color name as a character string (e.g. <code class="language-plaintext highlighter-rouge">"blue"</code>). You can also select colors by hex code or RGB value with other functions, details on which can be found on this helpful <a href="../fig/colorPaletteCheatsheet.pdf">R color guide</a>.</p>

<p>First, we can just specify a color for the whole plot using the argument <code class="language-plaintext highlighter-rouge">col = "&lt;color name&gt;"</code>.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">,</span><span class="w">
     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Length (cm)"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Width (cm)"</span><span class="p">,</span><span class="w">
     </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-04-class-manipulating-plotting-data-unnamed-chunk-30-1.png" title="plot of chunk unnamed-chunk-30" alt="plot of chunk unnamed-chunk-30" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>Of course, we don’t want all of the points to be blue. The <code class="language-plaintext highlighter-rouge">col</code> argument can also take a list that is the same length of the <code class="language-plaintext highlighter-rouge">x</code> and <code class="language-plaintext highlighter-rouge">y</code> arguments that assigns individual color values to each point. Since we know the species order for the point, we can use logical indexing to assign colors to each species.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># iris$Species is a factor, which makes things easier in this case</span><span class="w">
</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [1] setosa     setosa     setosa     setosa     setosa     setosa    
  [7] setosa     setosa     setosa     setosa     setosa     setosa    
 [13] setosa     setosa     setosa     setosa     setosa     setosa    
 [19] setosa     setosa     setosa     setosa     setosa     setosa    
 [25] setosa     setosa     setosa     setosa     setosa     setosa    
 [31] setosa     setosa     setosa     setosa     setosa     setosa    
 [37] setosa     setosa     setosa     setosa     setosa     setosa    
 [43] setosa     setosa     setosa     setosa     setosa     setosa    
 [49] setosa     setosa     versicolor versicolor versicolor versicolor
 [55] versicolor versicolor versicolor versicolor versicolor versicolor
 [61] versicolor versicolor versicolor versicolor versicolor versicolor
 [67] versicolor versicolor versicolor versicolor versicolor versicolor
 [73] versicolor versicolor versicolor versicolor versicolor versicolor
 [79] versicolor versicolor versicolor versicolor versicolor versicolor
 [85] versicolor versicolor versicolor versicolor versicolor versicolor
 [91] versicolor versicolor versicolor versicolor versicolor versicolor
 [97] versicolor versicolor versicolor versicolor virginica  virginica 
[103] virginica  virginica  virginica  virginica  virginica  virginica 
[109] virginica  virginica  virginica  virginica  virginica  virginica 
[115] virginica  virginica  virginica  virginica  virginica  virginica 
[121] virginica  virginica  virginica  virginica  virginica  virginica 
[127] virginica  virginica  virginica  virginica  virginica  virginica 
[133] virginica  virginica  virginica  virginica  virginica  virginica 
[139] virginica  virginica  virginica  virginica  virginica  virginica 
[145] virginica  virginica  virginica  virginica  virginica  virginica 
Levels: setosa versicolor virginica
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">levels</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] "setosa"     "versicolor" "virginica" 
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Let's define a list of colors to use in the plot. The color order </span><span class="w">
</span><span class="c1"># will be assigned in order of factor levels</span><span class="w">
</span><span class="n">col.list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">,</span><span class="w"> </span><span class="s2">"green"</span><span class="p">)</span><span class="w"> 

</span><span class="c1"># Recall that when we enter a factor as an index, R sees the underlying numeric representation</span><span class="w">
</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 [75] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3
[112] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
[149] 3 3
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Note: if you are are starting with a character vector, you can </span><span class="w">
</span><span class="c1"># achieve this same effect by first converting the charater to a factor,</span><span class="w">
</span><span class="c1"># then converting the factor to numeric: as.numeric(as.factor(x))</span><span class="w">

</span><span class="c1"># Taking advantage of this, we can directly index our color list and set # up a vector the length of iris$Species with a unique color value for </span><span class="w">
</span><span class="c1"># each species name</span><span class="w">
</span><span class="n">col.vector</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">col.list</span><span class="p">[</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">]</span><span class="w">
</span><span class="n">col.vector</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [1] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [10] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [19] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [28] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [37] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [46] "red"   "red"   "red"   "red"   "red"   "blue"  "blue"  "blue"  "blue" 
 [55] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [64] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [73] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [82] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [91] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
[100] "blue"  "green" "green" "green" "green" "green" "green" "green" "green"
[109] "green" "green" "green" "green" "green" "green" "green" "green" "green"
[118] "green" "green" "green" "green" "green" "green" "green" "green" "green"
[127] "green" "green" "green" "green" "green" "green" "green" "green" "green"
[136] "green" "green" "green" "green" "green" "green" "green" "green" "green"
[145] "green" "green" "green" "green" "green" "green"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># note that the lengths are indeed the same</span><span class="w">
</span><span class="nf">length</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">col.vector</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] TRUE
</code></pre></div></div>

<p> </p>

<p>Now that we have our color assignments stored in the <code class="language-plaintext highlighter-rouge">col.vector</code> variable, we can use that to color our plot by species.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">,</span><span class="w">
     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Length (cm)"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Width (cm)"</span><span class="p">,</span><span class="w">
     </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.vector</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-04-class-manipulating-plotting-data-unnamed-chunk-32-1.png" title="plot of chunk unnamed-chunk-32" alt="plot of chunk unnamed-chunk-32" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>As suspected, the lower left grouping is a single species. The other upper right grouping also breaks down nicely by species. But which is which? We can add a legend using the (you guessed it!) <code class="language-plaintext highlighter-rouge">legend()</code> function. First let’s look at the inputs:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">?</span><span class="n">legend</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>The <code class="language-plaintext highlighter-rouge">legend()</code> function is not very smart. It does not actually have access to any information about the plot, and requires that we give it all of information about what information to include. This can be annoying for basic plots, but it gives you the flexibility to customize the information in your charts to any degree that you like.</p>

<p>At a minimum, we need to give it the following arguments:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">x</code> tells R where to put the legend on the plot. You can give it simple direction like <code class="language-plaintext highlighter-rouge">"center"</code>, <code class="language-plaintext highlighter-rouge">left</code>, or <code class="language-plaintext highlighter-rouge">bottomright</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">legend</code> tells R the list of labels for the legend, in this case we want the species names in factor level order (yes, the argument name is the same)</li>
  <li><code class="language-plaintext highlighter-rouge">col</code> tells R the colors to display. We want to give it the same color order that we used to generate the species-matched color list.</li>
  <li><code class="language-plaintext highlighter-rouge">pch</code> tells R the type of symbol to display. By default, the <code class="language-plaintext highlighter-rouge">plot()</code> function sets <code class="language-plaintext highlighter-rouge">pch = 1</code>, but this does not have a default value in <code class="language-plaintext highlighter-rouge">legend()</code> for some reason. For now we want <code class="language-plaintext highlighter-rouge">pch = 1</code> to match the <code class="language-plaintext highlighter-rouge">plot()</code> default.</li>
</ul>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">legend</span><span class="p">(</span><span class="s2">"bottomright"</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levels</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="n">col.list</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-04-class-manipulating-plotting-data-unnamed-chunk-34-1.png" title="plot of chunk unnamed-chunk-34" alt="plot of chunk unnamed-chunk-34" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>Now we can see that the <em>Iris setosa</em> species has the small petals.</p>

<blockquote class="challenge">
  <h2 id="assigning-colors-based-on-contents-of-a-character-vector">Assigning colors based on contents of a character vector</h2>

  <p>What if the iris$Species were saved as a <code class="language-plaintext highlighter-rouge">character</code> instead of a <code class="language-plaintext highlighter-rouge">factor</code>? How 
would you go about generating your <code class="language-plaintext highlighter-rouge">col.list</code> input?</p>

  <p>Let’s define a new dataset where this is the case:</p>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iris2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">iris</span><span class="w">
</span><span class="n">iris2</span><span class="o">$</span><span class="n">Species</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>

  <blockquote class="solution">
    <h2 id="hint">Hint</h2>

    <p>Aside from just converting your character back to a vector, there is
a directly solution with the character vector. Check out the <code class="language-plaintext highlighter-rouge">unique()</code> and 
<code class="language-plaintext highlighter-rouge">match()</code> functions.</p>
  </blockquote>

  <blockquote class="solution">
    <h2 id="solution-1">Solution</h2>

    <p>First make sure our color list is defined:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Make sure our color list is defined</span><span class="w">
</span><span class="n">col.list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">,</span><span class="w"> </span><span class="s2">"green"</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <p>Here are two solutions:</p>

    <p>Option 1 – just convert the character to a factor</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Add the `as.factor()` function to the indexing when defining col.list</span><span class="w">
</span><span class="n">col.vector</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">col.list</span><span class="p">[</span><span class="n">as.factor</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">)]</span><span class="w">
</span><span class="n">col.vector</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [1] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [10] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [19] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [28] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [37] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [46] "red"   "red"   "red"   "red"   "red"   "blue"  "blue"  "blue"  "blue" 
 [55] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [64] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [73] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [82] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [91] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
[100] "blue"  "green" "green" "green" "green" "green" "green" "green" "green"
[109] "green" "green" "green" "green" "green" "green" "green" "green" "green"
[118] "green" "green" "green" "green" "green" "green" "green" "green" "green"
[127] "green" "green" "green" "green" "green" "green" "green" "green" "green"
[136] "green" "green" "green" "green" "green" "green" "green" "green" "green"
[145] "green" "green" "green" "green" "green" "green"
</code></pre></div>    </div>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Check the plot output</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">iris2</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris2</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">,</span><span class="w">
   </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Length (cm)"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Width (cm)"</span><span class="p">,</span><span class="w"> 
   </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.vector</span><span class="p">)</span><span class="w">
</span><span class="n">legend</span><span class="p">(</span><span class="s2">"bottomright"</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levels</span><span class="p">(</span><span class="n">as.factor</span><span class="p">(</span><span class="n">iris2</span><span class="o">$</span><span class="n">Species</span><span class="p">)),</span><span class="w"> 
   </span><span class="n">col</span><span class="o">=</span><span class="n">col.list</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-04-class-manipulating-plotting-data-unnamed-chunk-37-1.png" title="plot of chunk unnamed-chunk-37" alt="plot of chunk unnamed-chunk-37" width="612" style="display: block; margin: auto;" /></p>

    <p>Option 2 – Use the <code class="language-plaintext highlighter-rouge">match()</code> function to determine which color to 
assign to each element of col.vector based on the element of the 
species character vector.</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Now, since we don't have the underlying numeric structure of the </span><span class="w">
</span><span class="c1"># factor, we need a  way to generate the same index list with a </span><span class="w">
</span><span class="c1"># character vector. We can do this using the match() function.</span><span class="w">
</span><span class="n">species.list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="n">iris2</span><span class="o">$</span><span class="n">Species</span><span class="p">)</span><span class="w"> </span><span class="c1"># first grab the species list using unique()</span><span class="w">
</span><span class="n">species.list</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] "setosa"     "versicolor" "virginica" 
</code></pre></div>    </div>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># For each element in the first list, match() essentially asks R "where </span><span class="w">
</span><span class="c1"># is this element in the second list?" It returns the numeric position, </span><span class="w">
</span><span class="c1"># or index.</span><span class="w">
</span><span class="n">species.index</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">match</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">species.list</span><span class="p">)</span><span class="w">
</span><span class="n">species.index</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 [75] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3
[112] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
[149] 3 3
</code></pre></div>    </div>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># And we use the species.index in place of iris$Species to do the </span><span class="w">
</span><span class="c1"># indexing and generate our color list for each point on the plot</span><span class="w">
</span><span class="n">col.vector</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">col.list</span><span class="p">[</span><span class="n">species.index</span><span class="p">]</span><span class="w">
</span><span class="n">col.vector</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [1] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [10] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [19] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [28] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [37] "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"   "red"  
 [46] "red"   "red"   "red"   "red"   "red"   "blue"  "blue"  "blue"  "blue" 
 [55] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [64] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [73] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [82] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
 [91] "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue"  "blue" 
[100] "blue"  "green" "green" "green" "green" "green" "green" "green" "green"
[109] "green" "green" "green" "green" "green" "green" "green" "green" "green"
[118] "green" "green" "green" "green" "green" "green" "green" "green" "green"
[127] "green" "green" "green" "green" "green" "green" "green" "green" "green"
[136] "green" "green" "green" "green" "green" "green" "green" "green" "green"
[145] "green" "green" "green" "green" "green" "green"
</code></pre></div>    </div>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Finally, we can generate our plot. Note that we now use </span><span class="w">
</span><span class="c1"># "species.list" in place of "levels(iris$Species)" for the legend</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">iris2</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris2</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">,</span><span class="w">
     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Length (cm)"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Width (cm)"</span><span class="p">,</span><span class="w">
     </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.vector</span><span class="p">)</span><span class="w">
</span><span class="n">legend</span><span class="p">(</span><span class="s2">"bottomright"</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">species.list</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="n">col.list</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-04-class-manipulating-plotting-data-unnamed-chunk-38-1.png" title="plot of chunk unnamed-chunk-38" alt="plot of chunk unnamed-chunk-38" width="612" style="display: block; margin: auto;" /></p>
  </blockquote>
</blockquote>

<p> </p>
<h4 id="box-and-whisker-plots">Box and whisker plots</h4>

<p>We can now draw a scatter plot in R to look at the relationship between two variables. What if we want to compare a single data type across species? This is (still) most commonly done using bar charts with error bars. There is a movement in the biological sciences community to move away from bar charts and toward box and whisker plots. R is better equipped for the latter case any way, and that’s what we will work with in this course.</p>

<blockquote class="callout">
  <h2 id="why-use-box-and-whisker-charts-instead-of-bar-charts">Why use box and whisker charts instead of bar charts?</h2>

  <p>While bar charts are still more common and have their uses, box and whisker plots are
almost always better. A few problems with bar charts are that they:</p>
  <ul>
    <li>only show summary statistics (mean and variation)</li>
    <li>hide information on the shape of the data distribution</li>
    <li>can easily be used to misrepresent the size of differences between data</li>
    <li>do not have standard error bars (standard deviation and standard error are both common)</li>
  </ul>

  <p>Box and whisker plots provide a lot more detail about the data represented. A typical
box and whisker plot include:</p>
  <ul>
    <li>median (line in the middle of the box)</li>
    <li>quartiles (the size of the box)</li>
    <li>95 percentiles (whiskers)</li>
    <li>outliers (points beyond whiskers)</li>
    <li>all data points (less common, but a good idea)</li>
    <li>mean (also less common, but a good idea)</li>
  </ul>

</blockquote>

<p> </p>

<p>We can use the <code class="language-plaintext highlighter-rouge">boxplot()</code> function to generate box and whisker plots in R. To do so, we will usually use <code class="language-plaintext highlighter-rouge">formula</code> notation to enter the data. In this case, the first argument should be a formula indicating which data you want to plot and how your want it broken out, separated by the <code class="language-plaintext highlighter-rouge">~</code> symbol:</p>

<p>      <code class="language-plaintext highlighter-rouge">&lt;plot variable&gt; ~ &lt;separator variable&gt;</code></p>

<p>You can also provide the name of the data frame using the <code class="language-plaintext highlighter-rouge">data</code> argument, and then just use the column names directly in the formula. Let’s give both a try for Petal Length separated by Species in the iris dataset. These statements are equivalent, except for the axis labels:</p>

<p><img src="../fig/rmd-04-class-manipulating-plotting-data-unnamed-chunk-39-1.png" title="plot of chunk unnamed-chunk-39" alt="plot of chunk unnamed-chunk-39" width="612" style="display: block; margin: auto;" /></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">boxplot</span><span class="p">(</span><span class="n">Petal.Length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-04-class-manipulating-plotting-data-unnamed-chunk-39-2.png" title="plot of chunk unnamed-chunk-39" alt="plot of chunk unnamed-chunk-39" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>It is a best practice to show all your data points (at least until you have hundreds or thousands) on box plots, which we can add to our plot using the <code class="language-plaintext highlighter-rouge">stripchart()</code> function. The basic format is similar to that for <code class="language-plaintext highlighter-rouge">boxplot()</code>. We need to add a couple of arguments to make it work. The first is <code class="language-plaintext highlighter-rouge">add = TRUE</code>. This tells R to add the points to the current plot, instead of generating a new plot (which is the default behavior). The second is <code class="language-plaintext highlighter-rouge">vert = TRUE</code>, which tells R that we want the data plotted vertically (horizontal is the default for some reason). Let’s try it:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stripchart</span><span class="p">(</span><span class="n">Petal.Length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="n">add</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">vert</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-04-class-manipulating-plotting-data-unnamed-chunk-40-1.png" title="plot of chunk unnamed-chunk-40" alt="plot of chunk unnamed-chunk-40" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>Okay, the points are there, but they have some issues. Let’s add some information to improve the quality. Note that we need to rerun the boxplot command to regenerate the base plot before fixing the strip chart issues (otherwise they will just keep adding new points to the current chart and make a mess).</p>

<p>We will make the following changes:</p>

<p><code class="language-plaintext highlighter-rouge">boxplot()</code>:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">outline = FALSE</code> prevents outlier points from being plotted (strip chart will be plotting all of the points anyway).</li>
  <li><code class="language-plaintext highlighter-rouge">ylab = "Petal Length (cm)"</code> cleans up our y-axis label.</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">stripchart()</code>:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">pch = 16</code> in <code class="language-plaintext highlighter-rouge">stripchart()</code> changes the point from an open square to a solid circle, which is easier to see against the box plot.</li>
  <li><code class="language-plaintext highlighter-rouge">method = "jitter"</code> in <code class="language-plaintext highlighter-rouge">stripchart()</code> offsets each point in the “x” direction by a small random amount so that you can see overlapping points.</li>
</ul>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">boxplot</span><span class="p">(</span><span class="n">Petal.Length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w">
        </span><span class="n">outline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Petal Length (cm)"</span><span class="p">)</span><span class="w">
</span><span class="n">stripchart</span><span class="p">(</span><span class="n">Petal.Length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w">
           </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"jitter"</span><span class="p">,</span><span class="w">
           </span><span class="n">add</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">vert</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-04-class-manipulating-plotting-data-unnamed-chunk-41-1.png" title="plot of chunk unnamed-chunk-41" alt="plot of chunk unnamed-chunk-41" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>Better! Now this is a chart that is easy to read and shows all of the relevant data. <em>On Your Own</em> you will be digging into plotting in additional detail, including how to make multipanel plots and segregate data in boxplots by more than one independent variable.</p>

<hr />



<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>Use <code class="language-plaintext highlighter-rouge">mean</code>, <code class="language-plaintext highlighter-rouge">max</code>, <code class="language-plaintext highlighter-rouge">min</code>, and <code class="language-plaintext highlighter-rouge">sd</code> to calculate simple statistics.</p>
</li>
    
    <li><p>Use <code class="language-plaintext highlighter-rouge">plot</code> to create simple visualizations.</p>
</li>
    
    <li><p>Display simple graphs.</p>
</li>
    
    <li><p>Save a plot in a pdf file using <code class="language-plaintext highlighter-rouge">pdf(...)</code> and stop writing to the pdf file with <code class="language-plaintext highlighter-rouge">dev.off()</code>.</p>
</li>
    
  </ul>
</blockquote>

</article>
















<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../03-oyo-Lists/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../04-oyo-advanced-data-manipulation/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


      
      






<footer>
  <!--<div class="row">
    <div class="col-md-6 copyright" align="left">
	
    </div>
    <div class="col-md-6 help-links" align="right">
	
	
	<a href="/edit//_episodes_rmd/04-class-manipulating-plotting-data.Rmd">Edit on GitHub</a>
	
	
	/
	<a href="/blob//CONTRIBUTING.md">Contributing</a>
	/
	<a href="/">Source</a>
	/
	<a href="/blob//CITATION">Cite</a>
	/
	<a href="mailto:sutphin@gmail.com">Contact</a>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12" align="center">
      Using <a href="https://github.com/carpentries/styles/">The Carpentries style</a>
      version <a href="https://github.com/carpentries/styles/releases/tag/v9.5.3">9.5.3</a>.
    </div>
  </div>-->
</footer>

      
    </div>
    
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>
<!--<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>-->
<script type="text/javascript"
src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

  </body>
</html>
