















<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2024-08-15 20:50:19 -0700">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/syntax.css" />

    



    <!-- Favicons for everyone -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../assets/favicons/mcb585/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/favicons/mcb585/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/favicons/mcb585/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/favicons/mcb585/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../assets/favicons/mcb585/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../assets/favicons/mcb585/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../assets/favicons/mcb585/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../assets/favicons/mcb585/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content=" - MCB 585: Multidisciplinary/Quantitative Approaches to Solving Biological Problems"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="../assets/favicons/mcb585/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="../assets/favicons/mcb585/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="../assets/favicons/mcb585/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="../assets/favicons/mcb585/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="../assets/favicons/mcb585/mstile-310x310.png" />


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
    <title>MCB 585: Multidisciplinary/Quantitative Approaches to Solving Biological Problems: Hypothesis Testing</title>
  </head>
  <body>

    



    <div class="container">
      






<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      
      <a href="https://georgesutphin.github.io/MCB585/" class="pull-left">
        <img class="navbar-logo" src="../assets/img/mcb585-logo.svg" alt="MCB585 logo" />
      </a>
      

      
      <a class="navbar-brand" href="../">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>

        
	
        <li><a href="../setup.html">Setup</a></li>

        
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../01-class-introduction/index.html">Getting started with R and RStudio</a></li>
            
            <li><a href="../01-oyo-introduction/index.html">Getting started with R and RStudio -- Additional Detail</a></li>
            
            <li><a href="../02-class-R-data-types-structures/index.html">Basic Data Types and Data Structures in R</a></li>
            
            <li><a href="../02-oyo-R-data-types-in-depth/index.html">R Data Types -- In-Depth</a></li>
            
            <li><a href="../03-class-data-frames/index.html">Data Frames, Basic Indexing, Reading/Writing Data</a></li>
            
            <li><a href="../03-oyo-Lists/index.html">Lists and Advanced Indexing</a></li>
            
            <li><a href="../04-class-manipulating-plotting-data/index.html">Manipulating and Plotting Data</a></li>
            
            <li><a href="../04-oyo-advanced-data-manipulation/index.html">Advanced Data Manipulation and Plotting</a></li>
            
            <li><a href="../05-class-decisions-loops/index.html">Decision Making and Loops</a></li>
            
            <li><a href="../05-oyo-more-decisions-loops/index.html">Decision Making and Loops -- Additional Detail</a></li>
            
            <li><a href="../06-class-distributions/index.html">Distributions and Normality</a></li>
            
            <li><a href="../06-oyo-more-distributions/index.html">Distributions and Normality -- Additional Detail</a></li>
            
            <li><a href="../07-class-hypothesis-testing/index.html">Hypothesis Testing</a></li>
            
            <li><a href="../07-oyo-multiple-test-correction/index.html">Multiple Test Correction</a></li>
            
            <li><a href="../08-class-survival-analysis/index.html">Survival Analysis</a></li>
            
            <li><a href="../08-oyo-advanced-survival-analysis/index.html">Advanced Survival Analysis</a></li>
            
            <li><a href="../09-class-power-analysis/index.html">Power Analysis</a></li>
            
            <li><a href="../09-oyo-simulation/index.html">Simulating Experiments</a></li>
            
            <li><a href="../99-projects/index.html">Final Projects</a></li>
            
	    <li role="separator" class="divider"></li>
            <li><a href="../aio.html">All in one page (Beta)</a></li>
          </ul>
        </li>
	

	
	<!--
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../reference.html">Reference</a></li>
            
            <li><a href="../about/">About</a></li>
            
            <li><a href="../discuss/">Discussion</a></li>
            
            <li><a href="../figures/">Figures</a></li>
            
            <li><a href="../guide/">Instructor Notes</a></li>
            
          </ul>
        </li>
	-->

	
        <li><a href="../LICENSE.html">About</a></li>
	<!--
	
	<li><a href="/edit//_episodes_rmd/07-class-hypothesis-testing.Rmd">Improve this page <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
	
	-->
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>

















<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../06-oyo-more-distributions/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
    <h3 class="maintitle"><a href="../">MCB 585: Multidisciplinary/Quantitative Approaches to Solving Biological Problems</a></h3>
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../07-oyo-multiple-test-correction/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>

<article>
<div class="row">
  <div class="col-md-1">
  </div>
  <div class="col-md-10">
    <h1 class="maintitle">Hypothesis Testing</h1>
  </div>
  <div class="col-md-1">
  </div>
</div>


<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Class Date:</strong> 9/14/2023 -- In Class
      <br/>
      <strong>Teaching:</strong> 90 min
      <br/>
      <strong>Exercises:</strong> 30 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>What is the formal process for hypothesis testing?</p>
</li>
	
	<li><p>How does hypothesis testing relate to the population and sampling distributions?</p>
</li>
	
	<li><p>What are the assumptions of a t-test?</p>
</li>
	
	<li><p>What does a P-value mean?</p>
</li>
	
	<li><p>What is the right statistical test to use for my data?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Describe the steps of developing and testing a model.</p>
</li>
	
	<li><p>Formulate simple hypotheses.</p>
</li>
	
	<li><p>Conceptually describe the operations performed during a statistical test.</p>
</li>
	
	<li><p>Describe the assumptions of various statistical tests.</p>
</li>
	
	<li><p>Understand different types of variables.</p>
</li>
	
	<li><p>Conduct basic statistical tests in R.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h2 id="in-class">In Class</h2>

<p>In the last class we examined what we are actually doing statistically when take a sample from a population to run an experiment. In this lesson, we will take a similar look at hypothesis testing, define the formal process of formulating and testing a set of hypotheses, and examining the critical factors when selecting an appropriate statistical tool for a given set of data.</p>

<hr />
<h3 id="formulating-a-hypothesis">Formulating a hypothesis</h3>

<p>There is a basic process that we undertake as scientists to build our understanding of how a system works. This process comprises the following steps:</p>

<ol>
  <li>Develop a model.</li>
  <li>Formulate a hypothesis (and corresponding null hypothesis) based on that model.</li>
  <li>Collect a data sample.</li>
  <li>Run a statistical test to test the null hypothesis.</li>
  <li>Interpret the statistical test.</li>
  <li>Accept the null hypothesis or reject it in favor of the alternative.</li>
</ol>

<p>Let’s use the mouse study looking the role of a high-fat, high-sucrose diet on metabolism to examine each step. First, let’s load the data:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data.diet</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.delim</span><span class="p">(</span><span class="s2">"./data/b6.aj.hfhs.diet.txt"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>For a simple starting example, let’s say we are interested in the impact of genetic background on body weight. A first-order model can be simply stated:</p>

<p>      <strong>Model:</strong> <em>Body weight is determined, at least in part, by genetic background.</em></p>

<p>This model predicts that different genetic backgrounds should have different body weights at the same age. We can thus generate a hypothesis (\(H_1\)) and a corresponding null hypothesis (\(H_0\)). Note that a properly formed hypothesis should be a specific, falsifiable prediction about a change in an experimentally testable dependent variable following a change in an independent variable:</p>

<p> </p>

<p>       \(H_1\): <em>Age-matched mice from genetically distinct strain backgrounds will have different body weights on average.</em></p>

<p>       \(H_0\): <em>Age-matched mice from genetically distinct strain backgrounds will not have different body weights on average.</em></p>

<p> </p>

<p>Our high-fat, high-sucrose diet data set includes body weight measurements for two different strains, C57BL/6 and A/J, so we have a set of observations that can be used to test the hypothesis. From our class on distributions, we can translate the idealized version of these hypotheses as distributions:</p>

<p><img src="../fig/hypotheses.png" alt="Hypotheses" /></p>

<p>We are actually taking two samples, one from the C57BL/6J strain and one from the A/J strain. In essence, the null hypothesis is that the observations from each sample are drawn from the same effective population with respect to the measured phenotype (or at least populations with the same phenotype mean; bottom panel), while the alternative hypothesis is that the samples are drawn from separate populations with distinct distributions for the measured phenotype (top panel. We will talk more about the important features of these distributions when we get to <strong>Power Analysis</strong>.</p>

<p>First, we will examine the two distributions to see if there is a visual difference. There are a few ways to do this. Let’s start by plotting the density functions for the starting body weights for the two strains:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># define the density functions</span><span class="w">
</span><span class="n">dens.bw.b6</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">density</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"C57BL/6J"</span><span class="p">])</span><span class="w">
</span><span class="n">dens.bw.aj</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">density</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"A/J"</span><span class="p">])</span><span class="w">

</span><span class="c1"># define the plot limits</span><span class="w">
</span><span class="n">x.lim</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">dens.bw.b6</span><span class="o">$</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">dens.bw.aj</span><span class="o">$</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">dens.bw.b6</span><span class="o">$</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">dens.bw.aj</span><span class="o">$</span><span class="n">x</span><span class="p">))</span><span class="w">
</span><span class="n">y.lim</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">dens.bw.b6</span><span class="o">$</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">dens.bw.aj</span><span class="o">$</span><span class="n">y</span><span class="p">))</span><span class="w">

</span><span class="c1"># plot density functions</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">dens.bw.b6</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w">
     </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Body Weight (g)"</span><span class="p">,</span><span class="w">
     </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x.lim</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y.lim</span><span class="p">)</span><span class="w">

</span><span class="n">lines</span><span class="p">(</span><span class="n">dens.bw.aj</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-3-1.png" title="plot of chunk unnamed-chunk-3" alt="plot of chunk unnamed-chunk-3" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>Alternatively, we may want to look at the box and whisker plot for this data:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">boxplot</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="p">,</span><span class="w">     </span><span class="c1"># formula notation to plot body weight by strain</span><span class="w">
        </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Strain"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Body Weight (g)"</span><span class="p">,</span><span class="w"> </span><span class="c1"># add some axis labels</span><span class="w">
        </span><span class="n">outline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">)</span><span class="w">                                </span><span class="c1"># turn off outlier points</span><span class="w">
        
</span><span class="n">stripchart</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="p">,</span><span class="w">     </span><span class="c1"># formula notation to plot body weight by strain</span><span class="w">
        </span><span class="n">pch</span><span class="o">=</span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"blue"</span><span class="p">,</span><span class="s2">"red"</span><span class="p">),</span><span class="w">                  </span><span class="c1"># change the point type and color</span><span class="w">
        </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"jitter"</span><span class="p">,</span><span class="w">                            </span><span class="c1"># spread out the points in the x direction (instead of drawing them over eachother)</span><span class="w">
        </span><span class="n">vert</span><span class="o">=</span><span class="nb">T</span><span class="p">,</span><span class="n">add</span><span class="o">=</span><span class="nb">T</span><span class="p">)</span><span class="w">                                 </span><span class="c1"># draw the points vertically to match the direction of boxplot, and add to the current plot</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-4-1.png" title="plot of chunk unnamed-chunk-4" alt="plot of chunk unnamed-chunk-4" width="612" style="display: block; margin: auto;" /></p>

<p> </p>

<p>Well, they certainly look like distributions with different mean values. To determine whether the difference is large enough to reject the null hypothesis, we need to run a statistical test.</p>

<p>What are we actually doing when we run a statistical test? In the simplest form, we have a sample with a set of observations for our phenotype of interest. The goal of the test is to determine how likely it is that our sample came from the same population (again, with respect to the specific phenotype) that we are comparing to. In this case the population from a different genetic background. In our example, we are asking:</p>

<p>      <em>How likely is it that the sample of C57BL/6 body weight observations came from the same population as the A/J body weight observations?</em></p>

<p>Because of this framing, we are actually testing the <em>null hypothesis</em>, and will choose to accept it, or to reject it in favor of the alternative hypothesis. In running the statistical test, we make an assumption about the shape of the sampling distribution of the phenotype in the comparison population  for the sample size and simply ask how likely it would be to observe the mean from the measured sample given that assumption. Because of the Central Limit Theorem, the assumption that the sampling distribution is normally distributed is usually valid for large sample size (n), regardless of the actual shape of the population distribution.</p>

<p>Because we know the distribution of all possible samples for a normally distributed sample population, we can calculate the probability that our sample is drawn from the assumed sampling distribution (this is the P-value). The general rule of thumb is that if the probability is greater than 0.05 we accept the null hypothesis, while if the probability is less than 0.05, we reject the null hypothesis in favor of the alternative hypothesis.</p>

<p>We can visualize this procedure:</p>

<p><img src="../fig/hypothesis-test.png" alt="Hypotheses" /></p>

<p> </p>

<p>Each statistical test has an underlying set of assumptions. The t-test is the most common test used in biological sciences (though not always in the correct situations!). These assumptions must be met for the output of the test to be valid. The t-test makes the following assumptions:</p>

<ul>
  <li>The independent variable is bivariate (i.e. categorical with two categories)</li>
  <li>The dependent variable is continuous</li>
  <li>The sampling mean for the sample size is normally distributed for the two populations sampled (approximately true for large sample sizes under the Central Limit Theorem)</li>
  <li>Each observation of the dependent variable is independent of all other observations of the dependent variable (this is broken by, for example, cluster sampling or time-to-event/survival data)</li>
  <li>For the classical Student’s t-test, the two populations must have equal variance (i.e. the same standard deviation). However, Welch’s t-test generalizes the operation to populations with unequal variance. Unless you <em>know</em> that your populations have equal variance, assume unequal variance.</li>
</ul>

<p>We can check normality using the Q-Q plot and the Shapiro-Wilk test from last class:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"C57BL/6J"</span><span class="p">])</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"C57BL/6J"</span><span class="p">])</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-5-1.png" title="plot of chunk unnamed-chunk-5" alt="plot of chunk unnamed-chunk-5" width="612" style="display: block; margin: auto;" /></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">shapiro.test</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"C57BL/6J"</span><span class="p">])</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	Shapiro-Wilk normality test

data:  data.diet$bw_start[data.diet$strain == "C57BL/6J"]
W = 0.98847, p-value = 0.5732
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"A/J"</span><span class="p">])</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"A/J"</span><span class="p">])</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-5-2.png" title="plot of chunk unnamed-chunk-5" alt="plot of chunk unnamed-chunk-5" width="612" style="display: block; margin: auto;" /></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">shapiro.test</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"A/J"</span><span class="p">])</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	Shapiro-Wilk normality test

data:  data.diet$bw_start[data.diet$strain == "A/J"]
W = 0.98581, p-value = 0.3992
</code></pre></div></div>

<p> </p>

<p>Our data meet all of the other assumptions of the t-test. We can run a t-test using the <code class="language-plaintext highlighter-rouge">t.test()</code> function in R:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## ?t.test</span><span class="w">

</span><span class="c1"># We can either use formula notation...</span><span class="w">
</span><span class="n">t.test</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="p">,</span><span class="w">     
       </span><span class="n">alternative</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"two.sided"</span><span class="p">)</span><span class="w"> </span><span class="c1"># specify that we want a two-sided test</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	Welch Two Sample t-test

data:  data.diet$bw_start by data.diet$strain
t = -9.4095, df = 185.35, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means between group A/J and group C57BL/6J is not equal to 0
95 percent confidence interval:
 -2.835463 -1.852550
sample estimates:
     mean in group A/J mean in group C57BL/6J 
              17.47537               19.81938 
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ... or by explicitly entering the two data sets</span><span class="w">
</span><span class="n">t.test</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"C57BL/6J"</span><span class="p">],</span><span class="w"> 
       </span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"A/J"</span><span class="p">],</span><span class="w">                  
       </span><span class="n">alternative</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"two.sided"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	Welch Two Sample t-test

data:  data.diet$bw_start[data.diet$strain == "C57BL/6J"] and data.diet$bw_start[data.diet$strain == "A/J"]
t = 9.4095, df = 185.35, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 1.852550 2.835463
sample estimates:
mean of x mean of y 
 19.81938  17.47537 
</code></pre></div></div>

<p> </p>

<p>As we suspected from our plot, the P-value is highly significant, and we can reject the null hypothesis in favor of the alternative hypothesis.</p>

<hr />
<h3 id="choosing-the-right-statistical-test">Choosing the right statistical test</h3>

<p>One of the more common errors you see in hypothesis testing is application of the wrong statistical test to a given data set. By “wrong”, I just mean that the assumptions of the test are violated by some aspect of the underlying data.</p>

<p>What are the critical factors when selecting your test?</p>
<ul>
  <li>Number of dependent variables.</li>
  <li>Type(s) of dependent variable(s).</li>
  <li>Number of independent variables.</li>
  <li>Type(s) of independent variable(s).</li>
  <li>Distribution of the dependent variable.</li>
  <li>Sample size.</li>
  <li>Paired vs. unpaired observations between variables.</li>
</ul>

<p> </p>
<h4 id="variable-types">Variable types</h4>

<p>The nature of your variables is the first thing to consider when selecting a statistical test. In most situations, there are two broad categories of variable type (<em>categorical</em> and <em>numeric</em>), with sub-categories:</p>

<p>Variable type:</p>
<ul>
  <li><strong><u>Categorical</u></strong> variables are those that take on discrete or qualitative values. They are divided into three types:
    <ul>
      <li><strong>Nominal</strong> variables have two or more categories, but no intrinsic order. For example, flower color (“red”, “green”, “blue”) or state of residence (“Washington”, “Arizona”, “Maine”) are considered nominal variables.</li>
      <li><strong>Dichotomous</strong> variables are a subcategory of nominal variables with exactly two categories. For most studies, biological sex or gender (“female” or “male”) is considered dichotomous, as are questions with binary answers, e.g. “do you own a smart phone?” (“Yes” or “No”), censoring variables (0 = not censored, 1 = censored), or variables about current status (“Alive” or “Dead”).</li>
      <li><strong>Ordinal</strong> are similar to nominal, except with a clear order to the values (e.g. inflammation may be characterized as “none”, “low”, “moderate”, or “high”). Numeric variables are converted to ordinal values in certain circumstances using a threshold value (e.g. height observations can be converted to “tall” and “short” by taking values above or below a specified threshold value).</li>
    </ul>
  </li>
</ul>

<p> </p>

<ul>
  <li><strong><u>Numeric</u></strong> variables are quantifiable and meaningfully representable by numbers. To be considered “numerical”, the relative value must be numerically meaningful. Note that categories can be coded as numbers (see the censoring example under dichotomous variables above), but are not considered “numerical” because the relative value is not meaningful.
    <ul>
      <li><strong>Discrete</strong> variables denote quantities that are represented by whole numbers or counts. The number of items purchased at a store or the number of children in a family (i.e. “1” and “5” are meaningful, but “2.3” is not) are discrete variables.</li>
      <li><strong>Continuous</strong> variables are quantities that can be represented on a continuous number line and are not limited to discrete values. These can be further subdivided based on what type of comparison between two values is meaningful.</li>
      <li><strong>Interval</strong> variables have a consistent distance between numbered values. For example, the difference between 40 and 50 degrees Fahrenheit is the same as the difference between 90 and 100 degrees Fahrenheit.</li>
      <li><strong>Ratio</strong> variables have the same properties as interval variables, except that the point 0.0 is clearly defined, such that the ratio between two values is meaningful. For example, 50 degrees Fahrenheit is not twice as hot as 25 degrees Fahrenheit, while a person who is 6 feet tall can be considered “twice as tall” as a person who is 3 feet tall. Degrees Fahrenheit is thus an interval variable, but not a ratio variable, while height is both.</li>
    </ul>
  </li>
</ul>

<blockquote class="callout">
  <h2 id="more-complex-variables--eg-time-to-event-data">More complex variables – e.g. time-to-event data</h2>

  <p>There are special cases that require different considerations. 
Time-to-event (aka survival) data does not fit cleanly into the above 
categories. While the variable it putatively numeric 
(<em>how long did it take the event to occur?</em>), the way we observe the 
event actually makes the variable a repeated categorical observation on 
the same individual. We can’t just look at the whole timespan at once 
and say “the event happened at time t”. Instead, we observe the same 
sample of individuals at descrete intervals and ask 
(<em>has the event occurred yet?</em>). This structure means that observations 
are not independent and requires a test that does not make that 
assumption. Analysis of time-to-event data also generally requires a 
means to censor data, for example if a death was observed, but not from 
the cause of interest, or if a patient dropped out of a study. We will 
examine analysis of time-to-event data in a later lesson.</p>
</blockquote>

<p> </p>
<h4 id="sample-size-and-the-distribution-of-the-dependent-variable">Sample size and the distribution of the dependent variable</h4>

<p>We have spent a fair amount of time talking about distributions and what they say about our data. The primary place that this can matter is in fulfilling the assumptions of our selected statistical test. Types of tests can be categorized as <em>parametric</em> or <em>nonparametric</em>. While there is not a hard-and-fast definition for these terms <em>per se</em>, they are generally used as follows:</p>

<ul>
  <li>
    <p><strong>Parametric tests</strong> make an assumption about an underlying <em>parameter</em>, or <em>statistic</em>, in a dataset to calculate probabilities. In most cases, the assumption is that the statistic is drawn from a particular distribution (e.g. the normal distribution). The t-test is the most common example of this sort of test.</p>
  </li>
  <li>
    <p><strong>Nonparametric tests</strong> do not make assumptions about the underlying parameters or parameter distributions and use other means to calculate probabilities. Often they will rely on the rank-order of the data (e.g. the Log-Rank test).</p>
  </li>
</ul>

<p>Nonparametric tests are more robust than parametric tests in that they make fewer assumptions. However, they also have less statistical power to detect real differences (i.e. they are more conservative). You have a trade-off to consider if you have relatively low sample size (say &lt;30) and observations that are not clearly normally distributed.</p>

<p>As discussed previously, if you have a large sample size the distribution becomes less important. Parametric tests tend to be robust to non-normal data distributions with large sample sizes, while the reduction of power for nonparametric tests becomes less severe.</p>

<blockquote class="callout">
  <h2 id="how-many-is-enough">How many is enough?</h2>

  <p>While there are is no hard and fast rule for sample size, the Central 
Limit Theorem tends to hold for n &gt; 30 so long as the population size 
is much larger than the sample size. The assumption of
normality to be safely adopted in many cases. If your data is
dramatically skewed, try a transformation, use a nonparametric test, 
and/or adopt a more conservative interpretation.</p>
</blockquote>

<p> </p>
<h1 id="paired-vs-unpaired-data">Paired vs. unpaired data</h1>

<p>In some cases, data is paired between the two test groups. That is, there is a specific observation in one group that corresponds to a specific observation in another groups. This can be illustrated by an couple of examples:</p>

<ul>
  <li>
    <p><strong>Unpaired:</strong> Comparing body weight between two different strains of mouse. There is no specific relationship between one individual in <em>Strain A</em> and another individual in <em>Strain B</em>.</p>
  </li>
  <li>
    <p><strong>Paired:</strong> Comparing body weight of mice before and after being provided a particular diet for some time frame. In this case, you have body weight data from the same set of mice before and after the diet. The body weight for <em>Mouse A</em> before the diet is paired to the body weight for <em>Mouse A</em> after the diet.</p>
  </li>
</ul>

<p>If you have a data structure that allows for paired testing, it provides quite a bit more power to detect difference between groups. In the body weight example, pairing observations by measuring the same phenotype <em>before</em> vs. <em>after</em> a diet change controls for individual-to-individual variation in body weight within the population, which can be high. Unfortunately, most data is not paired.</p>

<p> </p>
<h4 id="available-statistical-tests">Available statistical tests</h4>

<p>There are many, many resources that provide information on selecting statistical tests from data. You should now have the basic information needed to find the right test. Pick your favorite table or flow chart to select your test. Here are some options:</p>

<ul>
  <li><a href="https://stats.idre.ucla.edu/other/mult-pkg/whatstat/">UCLA Institute for Digital Research &amp; Education</a> provides a table to guide the correct choice of test with handy links to the corresponding functions in R and other analysis tools.</li>
  <li><a href="http://www.biostathandbook.com/testchoice.html">Handbook of Biological Statistics</a> provides a table with a different organization and links to more detailed descriptions of each test.</li>
</ul>

<p>Here is an example of a flow chart for choosing a test. Many different versions of this type of chart are available online (original <a href="http://www.pnrjournal.com/article.asp?issn=0976-9234;year=2010;volume=1;issue=2;spage=61;epage=63;aulast=Jaykaran">here</a>):</p>

<p><img src="../fig/Statistical_Test_Flow_Chart.jpg" alt="Which test?" /></p>

<p> </p>
<h4 id="exercises">Exercises</h4>

<blockquote class="challenge">
  <h2 id="petal-length-by-species">Petal length by species?</h2>

  <p>Is there a significant difference (\(\alpha &lt; 0.05\)) in petal length 
among species in the <code class="language-plaintext highlighter-rouge">iris</code> dataset?</p>

  <blockquote class="solution">
    <h2 id="solution">Solution</h2>

    <p>Petal length is a continuous variable while species is categorical 
with 3 groups. First we can look at whether our data is normally 
distributed:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">)</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-7-1.png" title="plot of chunk unnamed-chunk-7" alt="plot of chunk unnamed-chunk-7" width="612" style="display: block; margin: auto;" /></p>

    <p>Not really close to normal… We can first try transforming the data 
to see if we can get the distribution to a more normal state.</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">))</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">))</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-8-1.png" title="plot of chunk unnamed-chunk-8" alt="plot of chunk unnamed-chunk-8" width="612" style="display: block; margin: auto;" /></p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">(</span><span class="nf">exp</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">))</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="nf">exp</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">))</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-8-2.png" title="plot of chunk unnamed-chunk-8" alt="plot of chunk unnamed-chunk-8" width="612" style="display: block; margin: auto;" /></p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">(</span><span class="m">1</span><span class="o">/</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">)</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="m">1</span><span class="o">/</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-8-3.png" title="plot of chunk unnamed-chunk-8" alt="plot of chunk unnamed-chunk-8" width="612" style="display: block; margin: auto;" /></p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">((</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">qqline</span><span class="p">((</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-8-4.png" title="plot of chunk unnamed-chunk-8" alt="plot of chunk unnamed-chunk-8" width="612" style="display: block; margin: auto;" /></p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">((</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="m">1</span><span class="o">/</span><span class="m">2</span><span class="p">))</span><span class="w">
</span><span class="n">qqline</span><span class="p">((</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="m">1</span><span class="o">/</span><span class="m">2</span><span class="p">))</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-8-5.png" title="plot of chunk unnamed-chunk-8" alt="plot of chunk unnamed-chunk-8" width="612" style="display: block; margin: auto;" /></p>

    <p>Nothing really helps, so that means nonparametric testing!</p>

    <p>Referencing the above chart, the best fir is the non-parametric ANOVA, &gt; &gt; also called the Kruskal-Wallis rank sum test. From the UCLA site 
above, we can find the appropriate R function:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">kruskal.test</span><span class="p">(</span><span class="n">Petal.Length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	Kruskal-Wallis rank sum test

data:  Petal.Length by Species
Kruskal-Wallis chi-squared = 130.41, df = 2, p-value &lt; 2.2e-16
</code></pre></div>    </div>

    <p>We conclude that species does affect petal length in irises. We can 
also visualize the differnece using a boxplot:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">boxplot</span><span class="p">(</span><span class="n">Petal.Length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="n">outline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">)</span><span class="w">
</span><span class="n">stripchart</span><span class="p">(</span><span class="n">Petal.Length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="w">
           </span><span class="n">vert</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"jitter"</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-10-1.png" title="plot of chunk unnamed-chunk-10" alt="plot of chunk unnamed-chunk-10" width="612" style="display: block; margin: auto;" /></p>

    <p> </p>

    <p>As a point of discussion, petal length does follow a reasonably 
normal distribution, if you look within each species:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">))</span><span class="w">
</span><span class="n">qqnorm</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">[</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"setosa"</span><span class="p">])</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">[</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"setosa"</span><span class="p">])</span><span class="w">
</span><span class="n">qqnorm</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">[</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"versicolor"</span><span class="p">])</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">[</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"versicolor"</span><span class="p">])</span><span class="w">
</span><span class="n">qqnorm</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">[</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"virginica"</span><span class="p">])</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">[</span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"virginica"</span><span class="p">])</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-11-1.png" title="plot of chunk unnamed-chunk-11" alt="plot of chunk unnamed-chunk-11" width="612" style="display: block; margin: auto;" /></p>

    <p> </p>

    <p>Assuming a normal distribution is warranted in this case because each 
of the independent samples appears to come from a normally distributed &gt; &gt; population. However, even if this sort of situation is present in your &gt; &gt; dataset, the source of the deviation from normality may not be your 
independent variable of interest. It may be that there is an unknown 
(and unmeasured) independent variable. If you can’t identify what is 
driving the non-normality, you have to continue your analysis without 
assuming that the data is normally distributed.</p>
  </blockquote>
</blockquote>

<p> </p>

<blockquote class="challenge">
  <h2 id="does-diet-affect-body-weight">Does diet affect body weight?</h2>

  <p>In our mouse diet data set (<em>b6.aj.hfhs.diet.txt</em>), is the impact of 
diet on body weight statistically significant (\(\alpha &lt; 0.05\))?</p>

  <blockquote class="solution">
    <h2 id="solution-1">Solution</h2>

    <p>First load the data and remind ourselves of the structure:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data.diet</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.delim</span><span class="p">(</span><span class="s2">"./data/b6.aj.hfhs.diet.txt"</span><span class="p">)</span><span class="w">
</span><span class="n">str</span><span class="p">(</span><span class="n">data.diet</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'data.frame':	191 obs. of  17 variables:
 $ strain         : chr  "A/J" "A/J" "A/J" "A/J" ...
 $ sex            : chr  "m" "m" "m" "m" ...
 $ animal_id      : int  16 17 18 19 20 21 22 23 24 25 ...
 $ animal_facility: chr  "ARC" "ARC" "ARC" "ARC" ...
 $ bw_start       : num  19.6 18.9 17.8 17.1 17.4 ...
 $ bw_end         : num  33.1 32.6 29.6 25.9 28.1 ...
 $ bw_gain        : num  13.51 13.74 11.73 8.85 10.66 ...
 $ body_length    : num  10.8 10.9 10.8 10.1 10.1 10.1 9.8 10.1 10.2 10.1 ...
 $ BMI            : num  0.28 0.27 0.25 0.25 0.28 0.28 0.31 0.28 0.29 0.3 ...
 $ GLU            : num  9.49 11.71 11.32 10.66 9.71 ...
 $ INS            : num  35.1 62.5 24.9 40.3 106.2 ...
 $ HOMA_IR        : num  2.09 4.58 1.77 2.69 6.46 2.25 8.88 5.23 3.07 4.45 ...
 $ CHOL           : num  3.17 3.15 2.63 3.38 2.76 2.65 3.43 2.86 3.12 3.07 ...
 $ TG             : num  1.07 1.54 0.86 0.66 0.8 0.66 1.07 1.47 0.76 0.8 ...
 $ liver_wt       : num  0.95 0.96 0.92 0.94 0.82 0.82 0.84 0.85 0.8 0.86 ...
 $ liver_TG       : int  114 95 107 67 109 79 49 36 60 104 ...
 $ liver_TG_tot   : num  108.3 91.4 98.5 63.1 89.3 ...
</code></pre></div>    </div>

    <p>Next examine the distribution of the before and after diet body 
weights.</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="p">)</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-13-1.png" title="plot of chunk unnamed-chunk-13" alt="plot of chunk unnamed-chunk-13" width="612" style="display: block; margin: auto;" /></p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_end</span><span class="p">)</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_end</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-13-2.png" title="plot of chunk unnamed-chunk-13" alt="plot of chunk unnamed-chunk-13" width="612" style="display: block; margin: auto;" /></p>

    <p>Starting body weight looks okay, but ending body weight looks very 
skewed. Learning from the above exercise using the <code class="language-plaintext highlighter-rouge">iris</code> data set, 
perhaps this is a strain effect? Let’s break it down further 
and recheck.</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span><span class="w">

</span><span class="n">qqnorm</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"C57BL/6J"</span><span class="p">])</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"C57BL/6J"</span><span class="p">])</span><span class="w">
</span><span class="n">qqnorm</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_end</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"C57BL/6J"</span><span class="p">])</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_end</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"C57BL/6J"</span><span class="p">])</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-14-1.png" title="plot of chunk unnamed-chunk-14" alt="plot of chunk unnamed-chunk-14" width="612" style="display: block; margin: auto;" /></p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"A/J"</span><span class="p">])</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"A/J"</span><span class="p">])</span><span class="w">
</span><span class="n">qqnorm</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_end</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"A/J"</span><span class="p">])</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_end</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"A/J"</span><span class="p">])</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-14-2.png" title="plot of chunk unnamed-chunk-14" alt="plot of chunk unnamed-chunk-14" width="612" style="display: block; margin: auto;" /></p>

    <p>That looks a lot closer (still a bit skewed on the high body weight 
side for C57BL/6J, but we have almost 100 mice, so we will go ahead 
with the normal assumption).</p>

    <p>Our data is paired, our independent variable is categorical (before 
vs. after HF-HS diet) and our dependent variable is continuous 
numeric. Since we are assuming normality, we can use a paired t-test 
(again broken down by strain, because that’s where are data are 
normal):</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">t.test</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"C57BL/6J"</span><span class="p">],</span><span class="w">
       </span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_end</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"C57BL/6J"</span><span class="p">],</span><span class="w">
       </span><span class="n">paired</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="w"> </span><span class="n">alternative</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"two.sided"</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	Paired t-test

data:  data.diet$bw_start[data.diet$strain == "C57BL/6J"] and data.diet$bw_end[data.diet$strain == "C57BL/6J"]
t = -44.553, df = 95, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -25.14135 -22.99636
sample estimates:
mean of the differences 
              -24.06885 
</code></pre></div>    </div>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">t.test</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"A/J"</span><span class="p">],</span><span class="w">
       </span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_end</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"A/J"</span><span class="p">],</span><span class="w">
       </span><span class="n">paired</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="w"> </span><span class="n">alternative</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"two.sided"</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	Paired t-test

data:  data.diet$bw_start[data.diet$strain == "A/J"] and data.diet$bw_end[data.diet$strain == "A/J"]
t = -31.834, df = 94, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -10.544198  -9.306118
sample estimates:
mean of the differences 
              -9.925158 
</code></pre></div>    </div>

    <p>Diet does significantly effect body weight in both strain backgrounds.
Let’s check out the box plot:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># first we have to build a data frame that has the data in the right </span><span class="w">
</span><span class="c1"># format</span><span class="w">
</span><span class="n">bw.data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">bw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="p">,</span><span class="w"> </span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_end</span><span class="p">),</span><span class="w"> 
                      </span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="s2">"start"</span><span class="p">,</span><span class="nf">length</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_start</span><span class="p">)),</span><span class="w">
                               </span><span class="nf">rep</span><span class="p">(</span><span class="s2">"end"</span><span class="p">,</span><span class="nf">length</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">bw_end</span><span class="p">))),</span><span class="w">
                      </span><span class="n">strain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="p">,</span><span class="w"> </span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="p">))</span><span class="w">

</span><span class="c1"># order the time variable so that it plots in the right order</span><span class="w">
</span><span class="n">bw.data</span><span class="o">$</span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">bw.data</span><span class="o">$</span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"start"</span><span class="p">,</span><span class="s2">"end"</span><span class="p">))</span><span class="w">

</span><span class="c1"># plot the boxplot and stripchart</span><span class="w">
</span><span class="n">bob</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">boxplot</span><span class="p">(</span><span class="n">bw</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">strain</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bw.data</span><span class="p">,</span><span class="w"> </span><span class="n">outline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">)</span><span class="w">
</span><span class="n">stripchart</span><span class="p">(</span><span class="n">bw</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">strain</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bw.data</span><span class="p">,</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="w">
        </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"jitter"</span><span class="p">,</span><span class="w"> </span><span class="n">vert</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-16-1.png" title="plot of chunk unnamed-chunk-16" alt="plot of chunk unnamed-chunk-16" width="612" style="display: block; margin: auto;" /></p>

    <p> </p>

    <p>From this we can clearly see the differences between starting and ending 
body weight for both strains, but the difference seems to be more severe for 
C57BL/6 mice. This likely explains the non-normal structure of the <code class="language-plaintext highlighter-rouge">bw_end</code> 
data when we looked at both strains combined.</p>
  </blockquote>
</blockquote>

<p> </p>

<blockquote class="challenge">
  <h2 id="does-strain-affect-body-weight-in-mice">Does strain affect body weight in mice?</h2>

  <p>A large study of different inbred strains was conducted in mice across 
lifespan. This data is stored in a file called <em>inbred.body.composition.txt</em>. 
Does strain background affect body weight in mice?</p>

  <blockquote class="solution">
    <h2 id="solution-2">Solution</h2>

    <p>Load the data and look at the structure:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data.bodycomp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.delim</span><span class="p">(</span><span class="s2">"./data/inbred.body.composition.txt"</span><span class="p">)</span><span class="w">
</span><span class="n">str</span><span class="p">(</span><span class="n">data.bodycomp</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'data.frame':	1187 obs. of  10 variables:
 $ strain       : chr  "129S1/SvImJ" "129S1/SvImJ" "129S1/SvImJ" "129S1/SvImJ" ...
 $ sex          : chr  "f" "f" "f" "f" ...
 $ animal_id    : chr  "SC-7749" "SC-7751" "SC-7752" "SC-7747" ...
 $ age          : int  6 6 6 6 6 6 6 6 6 6 ...
 $ body_weight_g: num  20.2 22.8 22.5 23.1 21.6 19.6 24 27.4 29.4 28.3 ...
 $ BMI          : num  2.66 2.88 2.97 2.92 2.85 2.71 2.96 3.38 3.33 3.49 ...
 $ percent_fat  : num  22.1 22.2 22.6 22.8 23.1 24 24.3 28.3 17.6 17.7 ...
 $ total_mass_g : num  17.9 19.8 19.4 20.6 18.9 17.3 21.3 25.1 26.5 25.9 ...
 $ lean_mass_g  : chr  "13.9" "15.4" "15" "15.9" ...
 $ fat_mass_g   : num  4.45 5.08 5.08 5.27 4.99 4.69 5.84 7.76 5.16 5 ...
</code></pre></div>    </div>

    <p>First look at normality within the body weight data.</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">(</span><span class="n">data.bodycomp</span><span class="o">$</span><span class="n">body_weight_g</span><span class="p">)</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">data.bodycomp</span><span class="o">$</span><span class="n">body_weight_g</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-18-1.png" title="plot of chunk unnamed-chunk-18" alt="plot of chunk unnamed-chunk-18" width="612" style="display: block; margin: auto;" /></p>

    <p>Looks like a deviation from normality toward the higher end of the body 
weight spectrum. Let’s try a log transformation.</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">data.bodycomp</span><span class="o">$</span><span class="n">body_weight_g</span><span class="p">))</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">data.bodycomp</span><span class="o">$</span><span class="n">body_weight_g</span><span class="p">))</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-19-1.png" title="plot of chunk unnamed-chunk-19" alt="plot of chunk unnamed-chunk-19" width="612" style="display: block; margin: auto;" /></p>

    <p>That looks better. Not perfect, but given the large sample size (n = 1187), 
we are going to assume that the sampling distribution is normal). Given our 
previous body weight examples, body weight within each strain group is also 
likey normally distributed. It would be tedious to check all of the strains, 
but we can take a quick peak at a selection:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">))</span><span class="w">

</span><span class="n">qqnorm</span><span class="p">(</span><span class="n">data.bodycomp</span><span class="o">$</span><span class="n">body_weight_g</span><span class="p">[</span><span class="n">data.bodycomp</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"C57BL/6J"</span><span class="p">])</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">data.bodycomp</span><span class="o">$</span><span class="n">body_weight_g</span><span class="p">[</span><span class="n">data.bodycomp</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"C57BL/6J"</span><span class="p">])</span><span class="w">
</span><span class="n">qqnorm</span><span class="p">(</span><span class="n">data.bodycomp</span><span class="o">$</span><span class="n">body_weight_g</span><span class="p">[</span><span class="n">data.bodycomp</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"DBA/2J"</span><span class="p">])</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">data.bodycomp</span><span class="o">$</span><span class="n">body_weight_g</span><span class="p">[</span><span class="n">data.bodycomp</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"DBA/2J"</span><span class="p">])</span><span class="w">
</span><span class="n">qqnorm</span><span class="p">(</span><span class="n">data.bodycomp</span><span class="o">$</span><span class="n">body_weight_g</span><span class="p">[</span><span class="n">data.bodycomp</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"WSB/EiJ"</span><span class="p">])</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">data.bodycomp</span><span class="o">$</span><span class="n">body_weight_g</span><span class="p">[</span><span class="n">data.bodycomp</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"WSB/EiJ"</span><span class="p">])</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-20-1.png" title="plot of chunk unnamed-chunk-20" alt="plot of chunk unnamed-chunk-20" width="612" style="display: block; margin: auto;" /></p>

    <p> </p>

    <p>Our dependent variable is continous, numeric (ratio) with an (assumed) 
normal distribution and our independent variable is catagroical with many 
levels. We can use an ANOVA test (<code class="language-plaintext highlighter-rouge">aov()</code> in R, rom the UCLA site). The 
UCLA notes that you have to request the <code class="language-plaintext highlighter-rouge">summary()</code> of the object created 
by <code class="language-plaintext highlighter-rouge">aov()</code> to see the P-values.</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">anova.bodycomp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aov</span><span class="p">(</span><span class="n">body_weight_g</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">strain</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data.bodycomp</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">anova.bodycomp</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>              Df Sum Sq Mean Sq F value Pr(&gt;F)    
strain        31  52618  1697.4   59.66 &lt;2e-16 ***
Residuals   1151  32745    28.4                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
4 observations deleted due to missingness
</code></pre></div>    </div>

    <p>The impact of strain on body weight is highly significant. Check out the 
visualization:</p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># first shrink the labels (cex) and add some more space the the bottom margin</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="p">,</span><span class="w"> </span><span class="n">mar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">12</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span><span class="w"> 
</span><span class="n">boxplot</span><span class="p">(</span><span class="n">body_weight_g</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">strain</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data.bodycomp</span><span class="p">,</span><span class="w"> 
        </span><span class="n">outline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="c1"># not outliers</span><span class="w">
        </span><span class="n">las</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="c1"># rotate the strain names so that they fit under each box</span><span class="w">
        </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="w"> </span><span class="c1"># turn of the "strain" x-axis label</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-07-class-hypothesis-testing-unnamed-chunk-22-1.png" title="plot of chunk unnamed-chunk-22" alt="plot of chunk unnamed-chunk-22" width="612" style="display: block; margin: auto;" /></p>
  </blockquote>
</blockquote>

<hr />



<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>Understand basic model development and testing.</p>
</li>
    
    <li><p>All statistical tests make assumptions about your sample and population. Understanding these assumptions is critical to running a valid test.</p>
</li>
    
  </ul>
</blockquote>

</article>
















<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../06-oyo-more-distributions/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../07-oyo-multiple-test-correction/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


      
      






<footer>
  <!--<div class="row">
    <div class="col-md-6 copyright" align="left">
	
    </div>
    <div class="col-md-6 help-links" align="right">
	
	
	<a href="/edit//_episodes_rmd/07-class-hypothesis-testing.Rmd">Edit on GitHub</a>
	
	
	/
	<a href="/blob//CONTRIBUTING.md">Contributing</a>
	/
	<a href="/">Source</a>
	/
	<a href="/blob//CITATION">Cite</a>
	/
	<a href="mailto:sutphin@gmail.com">Contact</a>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12" align="center">
      Using <a href="https://github.com/carpentries/styles/">The Carpentries style</a>
      version <a href="https://github.com/carpentries/styles/releases/tag/v9.5.3">9.5.3</a>.
    </div>
  </div>-->
</footer>

      
    </div>
    
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>
<!--<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>-->
<script type="text/javascript"
src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

  </body>
</html>
