















<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2024-08-15 20:50:19 -0700">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/syntax.css" />

    



    <!-- Favicons for everyone -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../assets/favicons/mcb585/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/favicons/mcb585/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/favicons/mcb585/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/favicons/mcb585/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../assets/favicons/mcb585/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../assets/favicons/mcb585/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../assets/favicons/mcb585/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../assets/favicons/mcb585/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="../assets/favicons/mcb585/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content=" - MCB 585: Multidisciplinary/Quantitative Approaches to Solving Biological Problems"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="../assets/favicons/mcb585/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="../assets/favicons/mcb585/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="../assets/favicons/mcb585/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="../assets/favicons/mcb585/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="../assets/favicons/mcb585/mstile-310x310.png" />


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
    <title>MCB 585: Multidisciplinary/Quantitative Approaches to Solving Biological Problems: Distributions and Normality -- Additional Detail</title>
  </head>
  <body>

    



    <div class="container">
      






<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      
      <a href="https://georgesutphin.github.io/MCB585/" class="pull-left">
        <img class="navbar-logo" src="../assets/img/mcb585-logo.svg" alt="MCB585 logo" />
      </a>
      

      
      <a class="navbar-brand" href="../">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>

        
	
        <li><a href="../setup.html">Setup</a></li>

        
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../01-class-introduction/index.html">Getting started with R and RStudio</a></li>
            
            <li><a href="../01-oyo-introduction/index.html">Getting started with R and RStudio -- Additional Detail</a></li>
            
            <li><a href="../02-class-R-data-types-structures/index.html">Basic Data Types and Data Structures in R</a></li>
            
            <li><a href="../02-oyo-R-data-types-in-depth/index.html">R Data Types -- In-Depth</a></li>
            
            <li><a href="../03-class-data-frames/index.html">Data Frames, Basic Indexing, Reading/Writing Data</a></li>
            
            <li><a href="../03-oyo-Lists/index.html">Lists and Advanced Indexing</a></li>
            
            <li><a href="../04-class-manipulating-plotting-data/index.html">Manipulating and Plotting Data</a></li>
            
            <li><a href="../04-oyo-advanced-data-manipulation/index.html">Advanced Data Manipulation and Plotting</a></li>
            
            <li><a href="../05-class-decisions-loops/index.html">Decision Making and Loops</a></li>
            
            <li><a href="../05-oyo-more-decisions-loops/index.html">Decision Making and Loops -- Additional Detail</a></li>
            
            <li><a href="../06-class-distributions/index.html">Distributions and Normality</a></li>
            
            <li><a href="../06-oyo-more-distributions/index.html">Distributions and Normality -- Additional Detail</a></li>
            
            <li><a href="../07-class-hypothesis-testing/index.html">Hypothesis Testing</a></li>
            
            <li><a href="../07-oyo-multiple-test-correction/index.html">Multiple Test Correction</a></li>
            
            <li><a href="../08-class-survival-analysis/index.html">Survival Analysis</a></li>
            
            <li><a href="../08-oyo-advanced-survival-analysis/index.html">Advanced Survival Analysis</a></li>
            
            <li><a href="../09-class-power-analysis/index.html">Power Analysis</a></li>
            
            <li><a href="../09-oyo-simulation/index.html">Simulating Experiments</a></li>
            
            <li><a href="../99-projects/index.html">Final Projects</a></li>
            
	    <li role="separator" class="divider"></li>
            <li><a href="../aio.html">All in one page (Beta)</a></li>
          </ul>
        </li>
	

	
	<!--
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../reference.html">Reference</a></li>
            
            <li><a href="../about/">About</a></li>
            
            <li><a href="../discuss/">Discussion</a></li>
            
            <li><a href="../figures/">Figures</a></li>
            
            <li><a href="../guide/">Instructor Notes</a></li>
            
          </ul>
        </li>
	-->

	
        <li><a href="../LICENSE.html">About</a></li>
	<!--
	
	<li><a href="/edit//_episodes_rmd/06-oyo-more-distributions.Rmd">Improve this page <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
	
	-->
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>

















<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../06-class-distributions/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
    <h3 class="maintitle"><a href="../">MCB 585: Multidisciplinary/Quantitative Approaches to Solving Biological Problems</a></h3>
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../07-class-hypothesis-testing/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>

<article>
<div class="row">
  <div class="col-md-1">
  </div>
  <div class="col-md-10">
    <h1 class="maintitle">Distributions and Normality -- Additional Detail</h1>
  </div>
  <div class="col-md-1">
  </div>
</div>


<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Class Date:</strong> 9/12/2023 -- On Your Own
      <br/>
      <strong>Teaching:</strong> 90 min
      <br/>
      <strong>Exercises:</strong> 30 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>Is there a statistical method for assessing normality?</p>
</li>
	
	<li><p>What options do I have if my data is not normally ditributed?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Be able to conduct a Shapiro-Wilk test in R, but also understand the limitations of this test.</p>
</li>
	
	<li><p>Carry out simple reversible data transformations to normalize data.</p>
</li>
	
	<li><p>Know where to go for more advanced data transformations.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h2 id="on-your-own">On Your Own</h2>

<p><em>In Class</em> we looked at visual/qualitative methods for assessing normality using histograms, density plots, and Q-Q plots. These remain the most common ways to make an initial assessment of normality before diving into statistical analysis. There are statistical tests for normality, and we will look at one of them, but these have caveats. The bottom line is this: it is <em>always</em> a good idea to look at how close your sample falls to the normal distribution. In the best case scenario, you can correct any deviations (see the section on transformations below). In the worst case you will be aware of any un-correctable deviations from normality and be in a position to apply an appropriate level of skepticism to P values that are borderline significant when a statistical test that makes the normality assumption is employed.</p>

<hr />
<h3 id="the-shapiro-wilk-test-for-normality">The Shapiro-Wilk test for normality</h3>

<p>While I will re-emphasize that it is <em>always</em> good to look at your data first, there is a statistical test for normality called the <a href="https://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test">Shapiro-Wilk test</a>, originally published in 1965. The Shapiro-Wilk test sets up the following hypotheses:</p>

<p>      \(H_0\): <em>The sample belongs to a normal distribution.</em></p>

<p> </p>

<p>      \(H_1\): <em>The sample does not belong to a normal distribution.</em></p>

<p>In essence, the test looks for statistical deviation from the corresponding theoretical normal distribution. First, let’s make sure we have our data loaded from the mouse diet study that we examined <em>In Class</em>:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data.diet</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.delim</span><span class="p">(</span><span class="s2">"./data/b6.aj.hfhs.diet.txt"</span><span class="p">)</span><span class="w">
</span><span class="n">b6</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.diet</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"C57BL/6J"</span><span class="p">,]</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>We can run the Shapiro-Wilk test in R using the <code class="language-plaintext highlighter-rouge">shapiro.test()</code> function:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">?</span><span class="n">shapiro.test</span><span class="w">
</span></code></pre></div></div>

<p> </p>

<p>The only argument that we need to pass to the test is a numeric vector containing our data of interest:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">shapiro.test</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_start</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	Shapiro-Wilk normality test

data:  b6$bw_start
W = 0.98847, p-value = 0.5732
</code></pre></div></div>

<p> </p>

<p>As we may have suspected from looking at the Q-Q plot and distributions <em>In Class</em>, the P-value is comfortably far from significance, and we can accept the null hypothesis that the sample is drawn from a normal distribution. As a demonstration, the exponential of this data is clearly not normal:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">(</span><span class="nf">exp</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_start</span><span class="p">))</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="nf">exp</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_start</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-06-oyo-more-distributions-unnamed-chunk-5-1.png" title="plot of chunk unnamed-chunk-5" alt="plot of chunk unnamed-chunk-5" width="612" style="display: block; margin: auto;" /></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">shapiro.test</span><span class="p">(</span><span class="nf">exp</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_start</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	Shapiro-Wilk normality test

data:  exp(b6$bw_start)
W = 0.56719, p-value = 2.251e-15
</code></pre></div></div>

<p> </p>

<p>Now that we have the tools, a question to consider: is it worth running a statistical test for normality?</p>

<blockquote class="callout">
  <h2 id="to-test-or-not-to-test">To test or not to test</h2>

  <p>When you start to read about testing normality, you get a lot of 
hand-wavy answers that amount to “just look at the Q-Q plot”. Is 
there value in running something like the Shapiro-Wilk test?</p>

  <p>The best answer is probably something like “not really, but it 
doesn’t hurt”. The problem with normality tests is that, if you 
have a large sample size, t-tests and other tests that assume a 
normally distributed sample tend to be quite robust even if your 
data is not that close to normal. On the other hand, the 
Shapiro-Wilk test, while one of the best-powered normality 
tests, is still under-powered for small sample sizes, which are 
the only cases where t-tests tend to under perform. See a detailed discussion in 
<a href="https://bmcmedresmethodol.biomedcentral.com/articles/10.1186/1471-2288-12-81">this paper</a>.</p>

  <p>At the risk of excessive repitition, it is <em>always</em> good to look 
at your data before running your analyses. A quick Q-Q plot will 
tell you whether your data is dramatically different from 
normality (in which case you may want to run a transformation; 
see the next section). That said, a statistical test like the 
Shapiro-Wilk test is not likely to tell you whether your data is 
meaningfully non-normal beyond what the Q-Q plot can divulge. A 
highly statistically significant answer will be obvious in the 
Q-Q plot, and a close answer should, at most, make you a bit more
skeptical of your 0.049 t-test p-value (which you should be anyway).</p>
</blockquote>

<hr />
<h3 id="transforming-highly-non-normal-data">Transforming highly non-normal data</h3>

<p>So what happens if your data is clearly non-normal? Let’s look at plasma triglycerides for our C57BL/6 mice:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">TG</span><span class="p">)</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">TG</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-06-oyo-more-distributions-unnamed-chunk-6-1.png" title="plot of chunk unnamed-chunk-6" alt="plot of chunk unnamed-chunk-6" width="612" style="display: block; margin: auto;" /></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">shapiro.test</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">TG</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	Shapiro-Wilk normality test

data:  b6$TG
W = 0.83851, p-value = 7.657e-09
</code></pre></div></div>

<p> </p>

<p>This sample looks to be clearly non-normal. In this case the data has a somewhat characteristic shape, with both low and values higher than expected from a normal distribution. What happens if we examine normality of the log of triglycerides?</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">TG</span><span class="p">))</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">TG</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-06-oyo-more-distributions-unnamed-chunk-7-1.png" title="plot of chunk unnamed-chunk-7" alt="plot of chunk unnamed-chunk-7" width="612" style="display: block; margin: auto;" /></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">shapiro.test</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">TG</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	Shapiro-Wilk normality test

data:  log(b6$TG)
W = 0.97882, p-value = 0.1227
</code></pre></div></div>

<p> </p>

<p>That’s much better! Now we can continue with our analysis using <code class="language-plaintext highlighter-rouge">log(b6$TG)</code> as our random variable, rather than the raw value of <code class="language-plaintext highlighter-rouge">b6$TG</code>. This is an ideal case, because taking the logarithm of a value is a <em>reversible</em> data transformation. We can easily reverse the process by raising <code class="language-plaintext highlighter-rouge">e</code> to the <code class="language-plaintext highlighter-rouge">log(b6$TG)</code> power (recall that by default, <code class="language-plaintext highlighter-rouge">log()</code> in R takes the natural logarithm of the input). Therefore, no information is lost when performing the transformation. Other reversible transformations include:</p>
<ul>
  <li>square root: \(\sqrt{x}\)</li>
  <li>polynomial powers (\(x^2\))</li>
  <li>inverse (\(\frac{1}{x}\))</li>
  <li>exponential (\(e^x\))</li>
</ul>

<p>The best reversible transformation is not always immediately obvious. You can just try a few until you find the one that gives the most normal outcome. However, in some cases you won’t be able to find a nice transformation that brings you closer to a normal distribution than you started with your raw data. You may also have outliers that are having an out-weighted effect. In these cases, you may need a more extreme measure. While we do not cover these options in detail, common approaches include using a <a href="https://en.wikipedia.org/wiki/Feature_scaling#Standardization_(Z-score_Normalization)">Z-Score Normalization</a>, a <a href="https://rdrr.io/bioc/DOQTL/man/rankZ.html">Rank Z Transformation</a>, or <a href="https://en.wikipedia.org/wiki/Feature_scaling#Rescaling_(min-max_normalization)">Min-Max Scaling</a>. These methods have different strengths and weaknesses, and tend to change some aspect of the data. For example, Min-Max Scaling suppresses the impact of outliers, while the Rank Z Transformation maintains data order, but forces a normal distribution and thus removes information about relative value.</p>

<hr />
<h3 id="exercises">Exercises</h3>

<blockquote class="challenge">
  <h2 id="assessing-normality-in-the-other-strain">Assessing normality in the other strain</h2>

  <p>We looked above at the starting body weight sample for C57BL/6 mice. Repeat our 
analysis using the A/J strain. In particular,</p>
  <ul>
    <li>Plot the histogram with density for the sample and normal distributions</li>
    <li>Generate a Q-Q plot to compare the sample to the normal distribution.</li>
    <li>Conduct a Shapiro-Wilk test on the sample.</li>
  </ul>

  <blockquote class="solution">
    <h2 id="solution">Solution</h2>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># First separate out the A/J data</span><span class="w">
</span><span class="n">aj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data.diet</span><span class="p">[</span><span class="n">data.diet</span><span class="o">$</span><span class="n">strain</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"A/J"</span><span class="p">,]</span><span class="w">

</span><span class="c1"># calculate histogram, density and normal ranges to prepare for plotting</span><span class="w">
</span><span class="n">hist.bw.aj</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hist</span><span class="p">(</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_start</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">freq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">warn.unused</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">)</span><span class="w">
</span><span class="n">dens.bw.aj</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">density</span><span class="p">(</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_start</span><span class="p">)</span><span class="w">
</span><span class="n">norm.x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_start</span><span class="p">),</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_start</span><span class="p">),</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w">
</span><span class="n">norm.y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dnorm</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">norm.x</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_start</span><span class="p">),</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sd</span><span class="p">(</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_start</span><span class="p">))</span><span class="w">

</span><span class="c1"># First calculate the range for the plot window size</span><span class="w">
</span><span class="n">x.lim</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">hist.bw.aj</span><span class="o">$</span><span class="n">mids</span><span class="p">,</span><span class="w"> </span><span class="n">dens.bw.aj</span><span class="o">$</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">norm.x</span><span class="p">),</span><span class="w"> </span><span class="c1"># find the lowest x value</span><span class="w">
           </span><span class="nf">max</span><span class="p">(</span><span class="n">hist.bw.aj</span><span class="o">$</span><span class="n">mids</span><span class="p">,</span><span class="w"> </span><span class="n">dens.bw.aj</span><span class="o">$</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">norm.x</span><span class="p">))</span><span class="w"> </span><span class="c1"># find the largest x value</span><span class="w">
</span><span class="n">y.lim</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="c1"># we want to plot y from 0 in this case</span><span class="w">
           </span><span class="nf">max</span><span class="p">(</span><span class="n">hist.bw.aj</span><span class="o">$</span><span class="n">density</span><span class="p">,</span><span class="w"> </span><span class="n">dens.bw.aj</span><span class="o">$</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">norm.y</span><span class="p">))</span><span class="w"> </span><span class="c1"># find the largest x value</span><span class="w">

</span><span class="c1"># now plot all three on the same chart</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">hist.bw.aj</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x.lim</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y.lim</span><span class="p">,</span><span class="w"> </span><span class="n">freq</span><span class="o">=</span><span class="nb">F</span><span class="p">)</span><span class="w"> 
</span><span class="n">lines</span><span class="p">(</span><span class="n">dens.bw.aj</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"black"</span><span class="p">)</span><span class="w">
</span><span class="n">lines</span><span class="p">(</span><span class="n">norm.x</span><span class="p">,</span><span class="n">norm.y</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-06-oyo-more-distributions-unnamed-chunk-8-1.png" title="plot of chunk unnamed-chunk-8" alt="plot of chunk unnamed-chunk-8" width="612" style="display: block; margin: auto;" /></p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># generate the Q-Q plot</span><span class="w">
</span><span class="n">qqnorm</span><span class="p">(</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_start</span><span class="p">)</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_start</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-06-oyo-more-distributions-unnamed-chunk-8-2.png" title="plot of chunk unnamed-chunk-8" alt="plot of chunk unnamed-chunk-8" width="612" style="display: block; margin: auto;" /></p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># conduct the Shapiro-Wilk test</span><span class="w">
</span><span class="n">shapiro.test</span><span class="p">(</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_start</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	Shapiro-Wilk normality test

data:  aj$bw_start
W = 0.98581, p-value = 0.3992
</code></pre></div>    </div>
  </blockquote>
</blockquote>

<p> </p>

<blockquote class="challenge">
  <h2 id="the-weightier-matter">The weightier matter</h2>

  <p>While the starting body weight is important, what we really care about is 
the change in body weight following the diet. Examine the <code class="language-plaintext highlighter-rouge">bw_gain</code> variable. 
Can we use this directly? Is there a better metric to assess change in body weight?</p>

  <blockquote class="solution">
    <h2 id="solution-1">Solution</h2>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># examine Q-Q plots for B6 and AJ mice separately</span><span class="w">
</span><span class="n">qqnorm</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_gain</span><span class="p">)</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_gain</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-06-oyo-more-distributions-unnamed-chunk-9-1.png" title="plot of chunk unnamed-chunk-9" alt="plot of chunk unnamed-chunk-9" width="612" style="display: block; margin: auto;" /></p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">shapiro.test</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_gain</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	Shapiro-Wilk normality test

data:  b6$bw_gain
W = 0.93757, p-value = 0.0001893
</code></pre></div>    </div>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">(</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_gain</span><span class="p">)</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_gain</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-06-oyo-more-distributions-unnamed-chunk-9-2.png" title="plot of chunk unnamed-chunk-9" alt="plot of chunk unnamed-chunk-9" width="612" style="display: block; margin: auto;" /></p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">shapiro.test</span><span class="p">(</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_gain</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	Shapiro-Wilk normality test

data:  aj$bw_gain
W = 0.94935, p-value = 0.001068
</code></pre></div>    </div>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># both are skewed. Try a log transformation:</span><span class="w">
</span><span class="n">qqnorm</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_gain</span><span class="p">))</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_gain</span><span class="p">))</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-06-oyo-more-distributions-unnamed-chunk-9-3.png" title="plot of chunk unnamed-chunk-9" alt="plot of chunk unnamed-chunk-9" width="612" style="display: block; margin: auto;" /></p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">shapiro.test</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_gain</span><span class="p">))</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	Shapiro-Wilk normality test

data:  log(b6$bw_gain)
W = 0.88267, p-value = 3.692e-07
</code></pre></div>    </div>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_gain</span><span class="p">))</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_gain</span><span class="p">))</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-06-oyo-more-distributions-unnamed-chunk-9-4.png" title="plot of chunk unnamed-chunk-9" alt="plot of chunk unnamed-chunk-9" width="612" style="display: block; margin: auto;" /></p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">shapiro.test</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_gain</span><span class="p">))</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	Shapiro-Wilk normality test

data:  log(b6$bw_gain)
W = 0.88267, p-value = 3.692e-07
</code></pre></div>    </div>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># That didn't work. What if we normalize to the starting body weight?</span><span class="w">
</span><span class="n">qqnorm</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_gain</span><span class="o">/</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_start</span><span class="p">)</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_gain</span><span class="o">/</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_start</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-06-oyo-more-distributions-unnamed-chunk-9-5.png" title="plot of chunk unnamed-chunk-9" alt="plot of chunk unnamed-chunk-9" width="612" style="display: block; margin: auto;" /></p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">shapiro.test</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_gain</span><span class="o">/</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_start</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	Shapiro-Wilk normality test

data:  b6$bw_gain/b6$bw_start
W = 0.98215, p-value = 0.2167
</code></pre></div>    </div>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">(</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_gain</span><span class="o">/</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_start</span><span class="p">)</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_gain</span><span class="o">/</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_start</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-06-oyo-more-distributions-unnamed-chunk-9-6.png" title="plot of chunk unnamed-chunk-9" alt="plot of chunk unnamed-chunk-9" width="612" style="display: block; margin: auto;" /></p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">shapiro.test</span><span class="p">(</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_gain</span><span class="o">/</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_start</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	Shapiro-Wilk normality test

data:  aj$bw_gain/aj$bw_start
W = 0.95953, p-value = 0.005023
</code></pre></div>    </div>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># still not perfect. Let's try to transform the new data with a square root</span><span class="w">
</span><span class="n">qqnorm</span><span class="p">(</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_gain</span><span class="o">/</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_start</span><span class="p">))</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_gain</span><span class="o">/</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_start</span><span class="p">))</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-06-oyo-more-distributions-unnamed-chunk-9-7.png" title="plot of chunk unnamed-chunk-9" alt="plot of chunk unnamed-chunk-9" width="612" style="display: block; margin: auto;" /></p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">shapiro.test</span><span class="p">(</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_gain</span><span class="o">/</span><span class="n">b6</span><span class="o">$</span><span class="n">bw_start</span><span class="p">))</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	Shapiro-Wilk normality test

data:  sqrt(b6$bw_gain/b6$bw_start)
W = 0.97056, p-value = 0.02933
</code></pre></div>    </div>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">(</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_gain</span><span class="o">/</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_start</span><span class="p">))</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_gain</span><span class="o">/</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_start</span><span class="p">))</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-06-oyo-more-distributions-unnamed-chunk-9-8.png" title="plot of chunk unnamed-chunk-9" alt="plot of chunk unnamed-chunk-9" width="612" style="display: block; margin: auto;" /></p>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="n">shapiro.test</span><span class="p">(</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_gain</span><span class="o">/</span><span class="n">aj</span><span class="o">$</span><span class="n">bw_start</span><span class="p">))</span><span class="w">
</span></code></pre></div>    </div>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	Shapiro-Wilk normality test

data:  sqrt(aj$bw_gain/aj$bw_start)
W = 0.98504, p-value = 0.3549
</code></pre></div>    </div>

    <p> </p>

    <p>Still not perfect, but this may be one of those cases where there isn’t a clean 
reversible transform. I would probably be comfortable going forward with the 
slightly skewed data and being congnizant of the problem when running my t-test, 
particularly given that we have nearly 100 observations in each sample, making 
the t-test more robust.</p>
  </blockquote>
</blockquote>

<p> </p>

<blockquote class="challenge">
  <h2 id="grand-challenge">Grand challenge</h2>

  <p>The “Normal Population Distribution” and “Sampling Distribution” charts
that we looked at <em>In Class</em> were both drawn in directly in R. Here they are 
again for reference:</p>

  <p><img src="../fig/population-distribution.png" alt="Normal Population Distribution" /></p>

  <p><img src="../fig/sampling-distribution.png" alt="Sampling Distribution" /></p>

  <p>Today’s <em>Grand Challenge</em>: reproduce as many elements of these charts as you 
can!</p>

  <p>*Note – this one is more “for fun”, and to demonstrate the power and 
versatility of R base graphics. Don’t spend a whole afternoon trying to get
every detail perfect (unless you really want to!).</p>

  <blockquote class="solution">
    <h2 id="hint--list-of-functions-used">Hint – list of functions used</h2>
    <ul>
      <li>arrows()</li>
      <li>axis()</li>
      <li>dev.off()</li>
      <li>dnorm()</li>
      <li>expression()</li>
      <li>mtext()</li>
      <li>par()</li>
      <li>paste()</li>
      <li>plot()</li>
      <li>png()</li>
      <li>polygon()</li>
      <li>rgb()</li>
      <li>seq()</li>
      <li>text()</li>
      <li>title()</li>
    </ul>
  </blockquote>

  <blockquote class="solution">
    <h2 id="solution-2">Solution</h2>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ---------------------------------------</span><span class="w">
</span><span class="c1"># Normal Population Distribution</span><span class="w">

</span><span class="c1"># Define set of points and corresponding points on normal distribution</span><span class="w">
</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">8</span><span class="p">,</span><span class="m">0.01</span><span class="p">)</span><span class="w">
</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dnorm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">

</span><span class="c1"># initiate PNG file</span><span class="w">
</span><span class="n">png</span><span class="p">(</span><span class="n">filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"results/population-distribution.png"</span><span class="p">,</span><span class="w">
    </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">750</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">525</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">150</span><span class="p">)</span><span class="w">

</span><span class="p">(</span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="p">,</span><span class="w"> </span><span class="c1"># default font size</span><span class="w">
    </span><span class="n">mar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">7</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span><span class="w"> </span><span class="c1"># increase margin sizes</span><span class="w">

</span><span class="c1"># Plot normal distribution</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w">  </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w"> </span><span class="c1"># plot the distribution as a line chart</span><span class="w">
     </span><span class="n">bty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w"> </span><span class="n">xaxt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"n"</span><span class="p">,</span><span class="w"> </span><span class="c1"># only use L shaped frame and turn off axes</span><span class="w">
     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="w">

</span><span class="c1"># Axis Labels</span><span class="w">
</span><span class="n">axis</span><span class="p">(</span><span class="n">side</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="o">:</span><span class="m">8</span><span class="p">,</span><span class="w"> 
     </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">expression</span><span class="p">(</span><span class="n">mu</span><span class="m">-4</span><span class="o">*</span><span class="n">sigma</span><span class="p">),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">mu</span><span class="m">-3</span><span class="o">*</span><span class="n">sigma</span><span class="p">),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">mu</span><span class="m">-2</span><span class="o">*</span><span class="n">sigma</span><span class="p">),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">mu</span><span class="o">-</span><span class="n">sigma</span><span class="p">),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">mu</span><span class="p">),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">mu</span><span class="o">+</span><span class="n">sigma</span><span class="p">),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">mu</span><span class="m">+2</span><span class="o">*</span><span class="n">sigma</span><span class="p">),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">mu</span><span class="m">+3</span><span class="o">*</span><span class="n">sigma</span><span class="p">),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">mu</span><span class="m">+4</span><span class="o">*</span><span class="n">sigma</span><span class="p">)))</span><span class="w">
</span><span class="n">mtext</span><span class="p">(</span><span class="s2">"Phenotype Value"</span><span class="p">,</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">font</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="p">)</span><span class="w">
</span><span class="n">mtext</span><span class="p">(</span><span class="s2">"Probability Density"</span><span class="p">,</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3.5</span><span class="p">,</span><span class="w"> </span><span class="n">font</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="p">)</span><span class="w">

</span><span class="c1"># Add title</span><span class="w">
</span><span class="n">title</span><span class="p">(</span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Normal\nPopulation\nDistribution"</span><span class="p">,</span><span class="w"> </span><span class="n">font</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="c1"># plot title in bold</span><span class="w">
      </span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-3</span><span class="p">,</span><span class="w"> </span><span class="n">adj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.03</span><span class="p">)</span><span class="w"> </span><span class="c1"># positioning on left inside plot region</span><span class="w">

</span><span class="c1"># add text identifying variables</span><span class="w">
</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">.4</span><span class="p">,</span><span class="m">0.37</span><span class="p">,</span><span class="w"> </span><span class="m">0.31</span><span class="p">),</span><span class="w"> </span><span class="n">adj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w">
     </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">expression</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="s2">" = "</span><span class="p">)),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span><span class="w"> </span><span class="s2">" = "</span><span class="p">)),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="s2">" = "</span><span class="p">))))</span><span class="w">
</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5.6</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.40</span><span class="p">,</span><span class="m">0.37</span><span class="p">,</span><span class="w"> </span><span class="m">0.34</span><span class="p">,</span><span class="w"> </span><span class="m">0.31</span><span class="p">),</span><span class="w"> </span><span class="n">adj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w">
     </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">expression</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"population mean"</span><span class="p">)),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"population standard"</span><span class="p">)),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"deviation"</span><span class="p">)),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"population size"</span><span class="p">))))</span><span class="w">

</span><span class="c1"># Fill in curve areas</span><span class="w">
</span><span class="n">col.fill</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rgb</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">0.2</span><span class="p">)</span><span class="w">
</span><span class="n">polygon</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">&gt;=</span><span class="m">6</span><span class="p">],</span><span class="w"> </span><span class="m">6</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">x</span><span class="o">&gt;=</span><span class="m">6</span><span class="p">],</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">x</span><span class="p">)]),</span><span class="w"> 
        </span><span class="n">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.fill</span><span class="p">)</span><span class="w">
</span><span class="n">polygon</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">&lt;=</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">x</span><span class="o">&lt;=</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">x</span><span class="p">)]),</span><span class="w"> 
        </span><span class="n">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.fill</span><span class="p">)</span><span class="w">
</span><span class="n">polygon</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">&gt;=</span><span class="m">5</span><span class="p">],</span><span class="w"> </span><span class="m">5</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">x</span><span class="o">&gt;=</span><span class="m">5</span><span class="p">],</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">x</span><span class="p">)]),</span><span class="w"> 
        </span><span class="n">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.fill</span><span class="p">)</span><span class="w">
</span><span class="n">polygon</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">&lt;=</span><span class="m">3</span><span class="p">],</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">x</span><span class="o">&lt;=</span><span class="m">3</span><span class="p">],</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">x</span><span class="p">)]),</span><span class="w"> 
        </span><span class="n">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.fill</span><span class="p">)</span><span class="w">
</span><span class="n">polygon</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">&gt;=</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">x</span><span class="o">&gt;=</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">x</span><span class="p">)]),</span><span class="w"> 
        </span><span class="n">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.fill</span><span class="p">)</span><span class="w">
</span><span class="n">polygon</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">&lt;=</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">x</span><span class="o">&lt;=</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">x</span><span class="p">)]),</span><span class="w"> 
        </span><span class="n">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.fill</span><span class="p">)</span><span class="w">

</span><span class="c1"># add arrows and data intervals</span><span class="w">
</span><span class="n">arrows</span><span class="p">(</span><span class="n">x0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.18</span><span class="p">,</span><span class="w"> </span><span class="n">x1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w">
       </span><span class="n">code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="c1"># draw arrow heads at both ends</span><span class="w">
       </span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">25</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.07</span><span class="p">)</span><span class="w"> </span><span class="c1"># arrow head angle and length</span><span class="w">
</span><span class="n">arrows</span><span class="p">(</span><span class="n">x0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.03</span><span class="p">,</span><span class="w"> </span><span class="n">x1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w">
       </span><span class="n">code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="c1"># draw arrow heads at both ends</span><span class="w">
       </span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">25</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.07</span><span class="p">)</span><span class="w"> </span><span class="c1"># arrow head angle and length</span><span class="w">

</span><span class="n">text</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">0.2</span><span class="p">,</span><span class="w"> </span><span class="s2">"68.3% of data"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.85</span><span class="p">)</span><span class="w">
</span><span class="n">text</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">0.05</span><span class="p">,</span><span class="w"> </span><span class="s2">"95.5% of data"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.85</span><span class="p">)</span><span class="w">

</span><span class="c1"># turn of graphics device</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span><span class="w">

</span><span class="c1"># ---------------------------------------</span><span class="w">
</span><span class="c1"># Sampling Distribution</span><span class="w">

</span><span class="c1"># Define set of points and corresponding points on normal distribution</span><span class="w">
</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">8</span><span class="p">,</span><span class="m">0.01</span><span class="p">)</span><span class="w">
</span><span class="n">y.pop</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dnorm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dnorm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">

</span><span class="n">x.lim</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="c1"># x plot limits</span><span class="w">
</span><span class="n">y.lim</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">y.pop</span><span class="p">)))</span><span class="w"> </span><span class="c1"># y plot limits</span><span class="w">

</span><span class="c1"># initiate PNG file</span><span class="w">
</span><span class="n">png</span><span class="p">(</span><span class="n">filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"results/sampling-distribution.png"</span><span class="p">,</span><span class="w">
    </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">750</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">525</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">150</span><span class="p">)</span><span class="w">
</span><span class="c1"># windows()</span><span class="w">

</span><span class="n">par</span><span class="p">(</span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="p">,</span><span class="w"> </span><span class="c1"># default font size</span><span class="w">
    </span><span class="n">mar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">))</span><span class="w"> </span><span class="c1"># increase margin sizes</span><span class="w">

</span><span class="c1"># Plot population distribution</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y.pop</span><span class="p">,</span><span class="w">  </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w">  </span><span class="c1"># plot the distribution as a line chart</span><span class="w">
     </span><span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">,</span><span class="w"> </span><span class="c1"># plot population in dotted blue</span><span class="w">
     </span><span class="n">bty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w"> </span><span class="n">xaxt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"n"</span><span class="p">,</span><span class="w"> </span><span class="c1"># only use L shaped frame and turn off axes</span><span class="w">
     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="c1"># no axis labels</span><span class="w">
     </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x.lim</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y.lim</span><span class="p">)</span><span class="w">

</span><span class="c1"># add sampling distribution</span><span class="w">
</span><span class="n">lines</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"black"</span><span class="p">)</span><span class="w">

</span><span class="c1"># Axis Labels</span><span class="w">
</span><span class="n">axis</span><span class="p">(</span><span class="n">side</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="o">:</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="m">9</span><span class="p">),</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="p">)</span><span class="w">
</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="o">:</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-0.055</span><span class="p">,</span><span class="w"> </span><span class="n">xpd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="p">,</span><span class="w">
     </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">expression</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="m">-4</span><span class="o">*</span><span class="n">SE</span><span class="p">[</span><span class="n">x</span><span class="p">]),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="m">-3</span><span class="o">*</span><span class="n">SE</span><span class="p">[</span><span class="n">x</span><span class="p">]),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="m">-2</span><span class="o">*</span><span class="n">SE</span><span class="p">[</span><span class="n">x</span><span class="p">]),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">-</span><span class="n">SE</span><span class="p">[</span><span class="n">x</span><span class="p">]),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="n">x</span><span class="p">]),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">+</span><span class="n">SE</span><span class="p">[</span><span class="n">x</span><span class="p">]),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="m">+2</span><span class="o">*</span><span class="n">SE</span><span class="p">[</span><span class="n">x</span><span class="p">]),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="m">+3</span><span class="o">*</span><span class="n">SE</span><span class="p">[</span><span class="n">x</span><span class="p">]),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="m">+4</span><span class="o">*</span><span class="n">SE</span><span class="p">[</span><span class="n">x</span><span class="p">])))</span><span class="w">
</span><span class="n">mtext</span><span class="p">(</span><span class="nf">expression</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"Sample Mean, "</span><span class="p">,</span><span class="w"> </span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">))),</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">font</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="p">)</span><span class="w">
</span><span class="n">mtext</span><span class="p">(</span><span class="s2">"Probability Density"</span><span class="p">,</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">font</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="p">)</span><span class="w">

</span><span class="c1"># Add title</span><span class="w">
</span><span class="n">title</span><span class="p">(</span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Sampling\nDistribution"</span><span class="p">,</span><span class="w"> </span><span class="n">font</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="c1"># plot title in bold</span><span class="w">
      </span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-2</span><span class="p">,</span><span class="w"> </span><span class="n">adj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.03</span><span class="p">)</span><span class="w"> </span><span class="c1"># positioning on left inside plot region</span><span class="w">

</span><span class="c1"># add text identifying variables</span><span class="w">
</span><span class="n">x.pos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">5.2</span><span class="w">
</span><span class="n">x.off</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0.9</span><span class="w">
</span><span class="n">y.pos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">  </span><span class="n">seq</span><span class="p">(</span><span class="m">0.4</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-0.028</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">)</span><span class="w">
</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x.pos</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y.pos</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span><span class="m">4</span><span class="o">:</span><span class="m">6</span><span class="p">,</span><span class="m">8</span><span class="p">)],</span><span class="w"> </span><span class="n">adj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">xpd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w">
     </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">expression</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="n">phantom</span><span class="p">(</span><span class="n">E</span><span class="p">),</span><span class="n">mu</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="w"> </span><span class="s2">"  = "</span><span class="p">)),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="n">phantom</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="n">x</span><span class="p">]),</span><span class="n">sigma</span><span class="p">,</span><span class="w"> </span><span class="s2">"  = "</span><span class="p">)),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="n">phantom</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="n">x</span><span class="p">]),</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="s2">"  = "</span><span class="p">)),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="n">phantom</span><span class="p">(</span><span class="n">Sn</span><span class="p">),</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="s2">"  = "</span><span class="p">)),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="n">SE</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="s2">"  = "</span><span class="p">)),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="n">phantom</span><span class="p">(</span><span class="n">SE</span><span class="p">[</span><span class="n">x</span><span class="p">]),</span><span class="s2">"  = "</span><span class="p">))))</span><span class="w">
</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x.pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x.off</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y.pos</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">6</span><span class="p">,</span><span class="m">8</span><span class="p">)],</span><span class="w"> </span><span class="n">adj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">xpd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w">
     </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">expression</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"sampling mean"</span><span class="p">)),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"population standard"</span><span class="p">)),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"deviation"</span><span class="p">)),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"population size"</span><span class="p">)),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"sample size"</span><span class="p">)),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"standard error of "</span><span class="p">,</span><span class="n">mu</span><span class="p">[</span><span class="n">x</span><span class="p">])),</span><span class="w">
                </span><span class="nf">expression</span><span class="p">(</span><span class="w">
                           </span><span class="n">paste</span><span class="p">(</span><span class="s2">" "</span><span class="p">,</span><span class="w"> </span><span class="n">frac</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)),</span><span class="w"> 
                           </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">frac</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="n">N</span><span class="m">-1</span><span class="p">))</span><span class="o">%~~%</span><span class="n">frac</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))))))</span><span class="w">

</span><span class="c1"># Label population distribution</span><span class="w">
</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.3</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.104</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">,</span><span class="w"> </span><span class="n">srt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">34</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="p">,</span><span class="w">
     </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Population Distribution"</span><span class="p">)</span><span class="w">

</span><span class="c1"># turn of graphics device</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span><span class="w">
</span></code></pre></div>    </div>

  </blockquote>
</blockquote>

<hr />



<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>Use shapiro.test() to perform at Shapiro-Wilk test of normality. However, the power of the test is such that a negative result can eitehr indicate insufficient sample size or lack of normality.</p>
</li>
    
    <li><p>Simple manipulations such as taking the logrithm or the square root of a sample can reversibly transform the observations into a more normal distribution.</p>
</li>
    
  </ul>
</blockquote>

</article>
















<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../06-class-distributions/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../07-class-hypothesis-testing/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


      
      






<footer>
  <!--<div class="row">
    <div class="col-md-6 copyright" align="left">
	
    </div>
    <div class="col-md-6 help-links" align="right">
	
	
	<a href="/edit//_episodes_rmd/06-oyo-more-distributions.Rmd">Edit on GitHub</a>
	
	
	/
	<a href="/blob//CONTRIBUTING.md">Contributing</a>
	/
	<a href="/">Source</a>
	/
	<a href="/blob//CITATION">Cite</a>
	/
	<a href="mailto:sutphin@gmail.com">Contact</a>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12" align="center">
      Using <a href="https://github.com/carpentries/styles/">The Carpentries style</a>
      version <a href="https://github.com/carpentries/styles/releases/tag/v9.5.3">9.5.3</a>.
    </div>
  </div>-->
</footer>

      
    </div>
    
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>
<!--<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>-->
<script type="text/javascript"
src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

  </body>
</html>
